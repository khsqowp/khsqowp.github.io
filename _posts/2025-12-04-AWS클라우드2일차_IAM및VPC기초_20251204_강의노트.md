---
title: "📝 AWS 클라우드 2일차 강의 노트 - IAM 및 VPC 기초"
date: 2025-12-04
excerpt: "학습 시간: 약 3시간"
categories:
  - AWS-Cloud
tags:
  - AWS-Cloud
  - SK_Rookies
---

# 📝 AWS 클라우드 2일차 강의 노트 - IAM 및 VPC 기초

**강의 날짜**: 2025년 12월 4일
**주제**: AWS 계정 관리(IAM) 및 가상 네트워크(VPC) 기초
**학습 시간**: 약 3시간

---

## 🎯 학습 목표

오늘 강의에서는 다음 내용을 학습합니다:

1. **1일차 복습**: AWS 클라우드 컴퓨팅의 핵심 개념 복습
2. **IAM(Identity and Access Management)**: AWS 계정 및 권한 관리 시스템 완전 마스터
3. **네트워크 기초**: TCP/IP, 라우팅, DNS 등 네트워크 핵심 개념 복습
4. **VPC(Virtual Private Cloud)**: AWS 가상 네트워크 구축 및 관리
5. **실습**: VPC 생성, 서브넷 구성, NAT Gateway 설정

---

## 📚 1일차 복습: AWS 클라우드 컴퓨팅 기초

### 🔹 AWS(Amazon Web Services) 소개

#### AWS란 무엇인가?

**AWS(Amazon Web Services)**는 아마존(Amazon)이라는 회사에서 제공하는 **클라우드 컴퓨팅 서비스**입니다.

**핵심 특징**:
- **200개 이상의 서비스** 제공
- 컴퓨팅, 스토리지, 데이터베이스, 네트워킹, AI/ML, IoT 등 다양한 영역
- 서비스를 **조합(Combination)**하여 사용자가 원하는 시스템 구축

**사용 방식**:
```
사용자 요구사항
    ↓
AWS 서비스 조합 선택
(EC2 + S3 + RDS + VPC 등)
    ↓
원하는 시스템 구축
```

#### 💡 중요 포인트

AWS는 "레고 블록"과 같습니다. 개별 서비스(레고 조각)를 조합하여 원하는 형태의 시스템(완성된 레고 작품)을 만드는 방식입니다.

---

### 🔹 클라우드 컴퓨팅의 정의 (NIST 기준)

#### NIST가 정의한 클라우드 컴퓨팅의 5가지 특징

**1. 온디맨드 셀프 서비스 (On-Demand Self-Service)**
- 사용자가 **스스로 직접** 필요할 때 리소스를 프로비저닝
- IT 관리자의 도움 없이 **즉시** 배포 가능
- 예시: AWS 콘솔에서 클릭 몇 번으로 EC2 인스턴스 생성

**2. 광범위한 네트워크 접근 (Broad Network Access)**
- **인터넷**을 통해 어디서나 접근 가능
- 다양한 디바이스(PC, 노트북, 스마트폰, 태블릿) 지원
- 표준 네트워크 프로토콜 사용 (HTTP, HTTPS 등)

**3. 리소스 풀링 (Resource Pooling)**
- 다수의 고객이 **공유하는 리소스 풀**
- 멀티 테넌트(Multi-Tenant) 모델
- 물리적 위치는 추상화되고, 사용자는 논리적 위치만 지정
- 예시: 서울 리전, 도쿄 리전 선택

**4. 빠른 탄력성 (Rapid Elasticity)**
- 수요에 따라 **자동으로 확장/축소** (Auto Scaling)
- 사용자에게는 **무한한 리소스**처럼 보임
- 트래픽 급증 시 즉시 대응 가능

**5. 측정 가능한 서비스 (Measured Service)**
- 리소스 사용량이 **자동으로 측정**됨
- 사용한 만큼만 비용 지불 (**종량제**)
- 투명한 비용 구조

#### 클라우드 컴퓨팅 한 문장 정의

> "클라우드 컴퓨팅은 **클라우드 컴퓨팅 제공 업체의 IT 리소스 풀을 인터넷을 통해 고객이 필요할 때, 업체의 도움 없이 스스로 직접 빠르게 배포하고 사용할 수 있게 하며, 사용한 리소스에 대해 측정되어 사용한 만큼 비용을 지불하는 종량제 요금제 서비스**입니다."

---

### 🔹 클라우드 서비스 모델: IaaS, PaaS, SaaS

#### 서비스 모델 비교

클라우드 서비스는 **누가 어디까지 관리하느냐**에 따라 3가지로 분류됩니다.

```mermaid
graph TB
    subgraph "온프레미스 (On-Premises)"
        A1[애플리케이션]
        A2[데이터]
        A3[런타임]
        A4[미들웨어]
        A5[OS]
        A6[가상화]
        A7[서버]
        A8[스토리지]
        A9[네트워크]
    end

    subgraph "IaaS (Infrastructure as a Service)"
        B1[애플리케이션 - 고객]
        B2[데이터 - 고객]
        B3[런타임 - 고객]
        B4[미들웨어 - 고객]
        B5[OS - 고객]
        B6[가상화 - 제공자]
        B7[서버 - 제공자]
        B8[스토리지 - 제공자]
        B9[네트워크 - 제공자]
    end

    subgraph "PaaS (Platform as a Service)"
        C1[애플리케이션 - 고객]
        C2[데이터 - 고객]
        C3[런타임 - 제공자]
        C4[미들웨어 - 제공자]
        C5[OS - 제공자]
        C6[가상화 - 제공자]
        C7[서버 - 제공자]
        C8[스토리지 - 제공자]
        C9[네트워크 - 제공자]
    end

    subgraph "SaaS (Software as a Service)"
        D1[애플리케이션 - 제공자]
        D2[데이터 - 고객]
        D3[런타임 - 제공자]
        D4[미들웨어 - 제공자]
        D5[OS - 제공자]
        D6[가상화 - 제공자]
        D7[서버 - 제공자]
        D8[스토리지 - 제공자]
        D9[네트워크 - 제공자]
    end
```

#### 1. IaaS (Infrastructure as a Service)

**개념**:
- 클라우드 제공자가 **하드웨어와 OS까지** 제공
- 고객은 **OS 위의 소프트웨어**를 설치 및 관리

**제공 범위**:
- 서버 (컴퓨팅 리소스)
- 스토리지 (저장 공간)
- 네트워크 (네트워킹 인프라)
- OS (운영 체제)

**고객 책임**:
- OS 패치 및 업데이트
- 애플리케이션 설치 및 관리
- 데이터 백업
- 보안 설정

**AWS IaaS 서비스 예시**:
- **EC2 (Elastic Compute Cloud)**: 가상 서버
- **EBS (Elastic Block Store)**: 블록 스토리지
- **S3 (Simple Storage Service)**: 객체 스토리지
- **VPC (Virtual Private Cloud)**: 가상 네트워크

**실제 사용 시나리오**:
```
상황: 웹 애플리케이션 배포 필요
    ↓
IaaS 사용:
1. EC2 인스턴스 생성 (Ubuntu OS 선택)
2. Nginx 웹 서버 설치
3. Node.js 런타임 설치
4. 애플리케이션 코드 배포
5. 데이터베이스 설정
6. 보안 그룹 설정
    ↓
결과: 직접 관리하는 웹 서버 운영
```

#### 2. PaaS (Platform as a Service)

**개념**:
- 클라우드 제공자가 **미들웨어, 런타임 엔진까지** 제공
- 고객은 **애플리케이션 코드와 데이터**만 관리

**제공 범위**:
- IaaS의 모든 것 +
- 런타임 환경 (Java, Python, Node.js 등)
- 미들웨어 (데이터베이스 엔진, 웹 서버 등)
- 개발 도구

**고객 책임**:
- 애플리케이션 코드 작성
- 데이터 관리
- 애플리케이션 설정

**AWS PaaS 서비스 예시**:
- **RDS (Relational Database Service)**: 관리형 데이터베이스
  - MySQL, PostgreSQL, Oracle 엔진까지 설치 및 관리
- **Elastic Beanstalk**: 애플리케이션 배포 플랫폼
- **Lambda**: 서버리스 컴퓨팅

**IaaS vs PaaS 비교 (RDS 예시)**:

| 구분 | IaaS (EC2 + MySQL 수동 설치) | PaaS (RDS) |
|:---:|:---:|:---:|
| **서버 프로비저닝** | 직접 EC2 생성 | RDS가 자동 생성 |
| **MySQL 설치** | 직접 설치 및 설정 | 자동 설치됨 |
| **패치 관리** | 직접 패치 적용 | 자동 패치 관리 |
| **백업** | 직접 백업 스크립트 작성 | 자동 백업 설정 |
| **고가용성** | 직접 클러스터 구성 | Multi-AZ 클릭 한 번 |
| **모니터링** | 직접 도구 설치 | CloudWatch 자동 통합 |
| **장점** | 완전한 제어 가능 | 운영 부담 대폭 감소 |
| **단점** | 운영 부담 큼 | 세부 설정 제약 있음 |

**실제 사용 시나리오 (RDS)**:
```
상황: MySQL 데이터베이스 필요
    ↓
PaaS (RDS) 사용:
1. RDS 콘솔에서 MySQL 선택
2. 인스턴스 타입 선택 (db.t3.medium)
3. 스토리지 크기 지정 (100GB)
4. 자동 백업 설정 (7일 보관)
5. Multi-AZ 활성화 (고가용성)
    ↓
결과: 5분 만에 운영 준비 완료!
     패치, 백업, 장애 조치 모두 자동
```

#### 3. SaaS (Software as a Service)

**개념**:
- 클라우드 제공자가 **애플리케이션까지 모두** 제공
- 고객은 **데이터만 입력**하고 서비스 사용

**제공 범위**:
- 완성된 애플리케이션
- 모든 인프라 및 플랫폼
- 유지보수 및 업데이트

**고객 책임**:
- 데이터 입력 및 관리
- 애플리케이션 설정 (사용자 정의)
- 비즈니스 로직 최적화

**대표적인 SaaS 예시**:

1. **Salesforce (세일즈포스)**
   - CRM (고객 관계 관리) 소프트웨어
   - 영업, 마케팅, 고객 서비스 기능 제공
   - 사용자는 고객 데이터만 입력

2. **Google Workspace (구글 워크스페이스)**
   - Gmail, Google Drive, Google Docs
   - 웹 브라우저만 있으면 사용 가능

3. **Microsoft 365**
   - Word, Excel, PowerPoint 온라인 버전
   - OneDrive 스토리지 포함

4. **Dropbox**
   - 파일 동기화 및 공유 서비스

**AWS SaaS 서비스 예시**:
- **Amazon WorkSpaces**: 가상 데스크톱
- **Amazon Chime**: 화상 회의 솔루션
- **Amazon QuickSight**: 비즈니스 인텔리전스 (BI)

**실제 사용 시나리오 (Salesforce)**:
```
상황: 영업팀의 고객 관리 필요
    ↓
SaaS (Salesforce) 사용:
1. Salesforce 계정 생성
2. 웹 브라우저에서 로그인
3. 고객 정보 입력
4. 영업 파이프라인 관리
5. 자동 보고서 생성
    ↓
결과: 서버, DB, 애플리케이션 개발 불필요
     데이터 입력과 활용에만 집중
```

#### 서비스 모델 선택 가이드

| 상황 | 추천 모델 | 이유 |
|:---|:---:|:---|
| 완전한 커스터마이징 필요 | **IaaS** | 모든 소프트웨어를 직접 설치하고 설정 가능 |
| 빠른 개발 및 배포 필요 | **PaaS** | 인프라 관리 부담 없이 코드 작성에 집중 |
| 즉시 사용 가능한 솔루션 필요 | **SaaS** | 설치 없이 바로 사용, 유지보수 불필요 |
| 레거시 시스템 마이그레이션 | **IaaS** | 기존 설정을 그대로 옮길 수 있음 |
| 스타트업의 빠른 프로토타이핑 | **PaaS** | 최소 인력으로 빠른 개발 가능 |
| 비개발 부서의 업무 도구 | **SaaS** | IT 지식 없이 바로 사용 가능 |

---

### 🔹 클라우드 배포 모델

클라우드는 **누가 사용하느냐**에 따라 배포 모델이 구분됩니다.

#### 1. 프라이빗 클라우드 (Private Cloud)

**개념**:
- **특정 조직 또는 기업**만 사용하는 클라우드
- 자체 데이터 센터에 구축하거나 전용 인프라 임대

**특징**:
- ✅ **높은 보안성**: 외부와 완전히 격리
- ✅ **완전한 제어**: 모든 설정을 직접 관리
- ✅ **규정 준수 용이**: 금융, 의료 등 규제 산업에 적합
- ❌ **높은 초기 비용**: 인프라 구축 비용 큰 부담
- ❌ **운영 부담**: 전문 인력 필요

**사용 사례**:
- 은행, 증권사 (금융 데이터 보호)
- 병원 (환자 정보 보호)
- 정부 기관 (국가 기밀 보호)

**구축 방식**:
```
자체 구축:
    데이터 센터 건설
    → 서버, 스토리지, 네트워크 장비 구매
    → 가상화 소프트웨어 설치 (VMware, OpenStack)
    → 클라우드 관리 플랫폼 구축

전용 인프라 임대:
    AWS Outposts
    → AWS 하드웨어를 고객 사내에 설치
    → AWS 서비스를 온프레미스에서 사용
```

#### 2. 퍼블릭 클라우드 (Public Cloud)

**개념**:
- **누구나 사용할 수 있는** 공개된 클라우드
- 인터넷을 통해 접근 가능

**특징**:
- ✅ **저렴한 비용**: 종량제 요금, 초기 투자 불필요
- ✅ **빠른 시작**: 몇 분 안에 리소스 생성 가능
- ✅ **무한한 확장성**: 필요한 만큼 리소스 추가
- ✅ **최신 기술**: 지속적인 업데이트 및 신기능 추가
- ❌ **보안 우려**: 멀티 테넌트 환경 (논리적 격리)
- ❌ **규정 준수 제약**: 일부 산업에서 사용 제한

**주요 퍼블릭 클라우드 제공자**:

| 제공자 | 특징 | 주요 서비스 |
|:---|:---|:---|
| **AWS** | 시장 점유율 1위, 가장 많은 서비스 | EC2, S3, Lambda, RDS |
| **Microsoft Azure** | 기업용, MS 제품 통합 우수 | Virtual Machines, Cosmos DB |
| **Google Cloud (GCP)** | AI/ML 강점, 빅데이터 분석 | Compute Engine, BigQuery |
| **Alibaba Cloud** | 중국 시장 1위 | ECS, OSS, RDS |
| **Oracle Cloud** | 데이터베이스 강점 | Autonomous Database |
| **IBM Cloud** | 하이브리드 클라우드 강점 | Red Hat OpenShift |

**AWS의 글로벌 영향력**:
- 전 세계 33~34개 리전
- 105개 이상의 가용 영역
- 410개 이상의 엣지 로케이션
- 245개 이상의 국가 및 지역에서 서비스

#### 3. 하이브리드 클라우드 (Hybrid Cloud)

**개념**:
- **프라이빗 클라우드**와 **퍼블릭 클라우드**를 **연결**하여 함께 사용
- 또는 서로 다른 배포 모델을 2개 이상 결합

**특징**:
- ✅ **유연성**: 워크로드에 따라 최적 환경 선택
- ✅ **비용 최적화**: 중요 데이터는 프라이빗, 나머지는 퍼블릭
- ✅ **규정 준수**: 민감 데이터는 온프레미스 보관
- ✅ **점진적 마이그레이션**: 단계적 클라우드 전환 가능
- ❌ **복잡성**: 두 환경 모두 관리 필요
- ❌ **연결 의존성**: 네트워크 안정성 중요

**실제 사용 시나리오**:

**시나리오 1: 금융사의 하이브리드 환경**
```
프라이빗 클라우드 (온프레미스):
- 고객 금융 정보 (규제 준수 필요)
- 거래 처리 시스템 (핵심 업무)
- 내부 직원 시스템

퍼블릭 클라우드 (AWS):
- 마케팅 웹사이트
- 모바일 앱 백엔드
- 빅데이터 분석 (고객 행동 분석)
- 개발/테스트 환경

연결:
- AWS Direct Connect (전용선)
- VPN (가상 사설망)
```

**시나리오 2: 클라우드 버스팅 (Cloud Bursting)**
```
평상시:
    온프레미스 서버로 처리
    (예: 일일 트래픽 1만 명)

블랙프라이데이 (트래픽 급증):
    온프레미스: 기본 부하 처리
    +
    AWS: 추가 트래픽 처리
    (예: 트래픽 100만 명)

이벤트 종료:
    다시 온프레미스만 사용
    AWS 리소스 자동 종료
```

**AWS의 하이브리드 클라우드 솔루션**:
- **AWS Outposts**: AWS 인프라를 고객 사내에 설치
- **AWS Direct Connect**: 전용선 연결 (안정적이고 빠른 연결)
- **AWS Storage Gateway**: 온프레미스와 S3 간 데이터 동기화
- **AWS VPN**: 암호화된 네트워크 연결

#### 4. 커뮤니티 클라우드 (Community Cloud)

**개념**:
- **공통 이해관계**가 있는 여러 조직이 **공유**하는 클라우드
- NIST 정의에는 포함되지만 실무에서는 덜 사용되는 용어

**특징**:
- 비슷한 요구사항을 가진 조직들이 비용 분담
- 프라이빗보다 저렴, 퍼블릭보다 안전

**사용 사례**:
- 대학 연합 클라우드 (교육 기관 전용)
- 병원 네트워크 클라우드 (의료 데이터 공유)
- 정부 기관 클라우드 (G-Cloud)

---

### 🔹 AWS의 핵심 특징

#### 1. 공동 책임 모델 (Shared Responsibility Model)

**개념**:
AWS와 고객이 **보안 책임을 공유**하는 모델입니다.

```mermaid
graph TB
    subgraph "고객 책임 (Security IN the Cloud)"
        A1[고객 데이터]
        A2[플랫폼, 애플리케이션, IAM]
        A3[운영 체제, 네트워크, 방화벽 설정]
        A4[클라이언트 측 데이터 암호화]
        A5[서버 측 암호화]
        A6[네트워크 트래픽 보호]
    end

    subgraph "AWS 책임 (Security OF the Cloud)"
        B1[소프트웨어]
        B2[컴퓨팅, 스토리지, 데이터베이스, 네트워킹]
        B3[하드웨어 / AWS 글로벌 인프라]
        B4[리전, 가용 영역, 엣지 로케이션]
    end

    A6 --> B1
```

**AWS 책임 (Security OF the Cloud)**:
- ✅ 물리적 데이터 센터 보안
- ✅ 하드웨어 유지보수
- ✅ 네트워크 인프라 보안
- ✅ 가상화 계층 보안
- ✅ 리전 및 가용 영역 운영

**고객 책임 (Security IN the Cloud)**:
- ✅ OS 패치 및 업데이트
- ✅ 애플리케이션 보안
- ✅ 데이터 암호화
- ✅ IAM (계정 및 권한 관리)
- ✅ 방화벽 설정 (Security Group, NACL)
- ✅ 네트워크 트래픽 암호화

**서비스 유형별 책임 범위**:

| 서비스 유형 | 예시 | AWS 책임 | 고객 책임 |
|:---|:---|:---|:---|
| **IaaS** | EC2, VPC | 인프라 (하드웨어~가상화) | OS, 애플리케이션, 데이터, 네트워크 설정 |
| **PaaS** | RDS, Elastic Beanstalk | 인프라 + OS + 런타임 | 애플리케이션, 데이터, 접근 제어 |
| **SaaS** | AWS Managed Services | 거의 모든 것 | 데이터, 접근 제어, 사용자 관리 |

💡 **핵심 기억 사항**: "**AWS는 클라우드의 보안을, 고객은 클라우드 내부의 보안을 책임진다**"

---

## ✅ 섹션 1 학습 체크리스트

- [ ] AWS가 무엇인지 설명할 수 있다
- [ ] 클라우드 컴퓨팅의 5가지 특징(NIST)을 이해한다
- [ ] IaaS, PaaS, SaaS의 차이를 구분할 수 있다
- [ ] 프라이빗/퍼블릭/하이브리드 클라우드를 설명할 수 있다
- [ ] AWS 공동 책임 모델을 이해한다

---

## 📋 섹션 1 핵심 요약

### 1. AWS 소개
- 아마존의 클라우드 컴퓨팅 서비스
- 200개 이상의 서비스를 조합하여 사용

### 2. 클라우드 컴퓨팅 특징 (NIST)
1. 온디맨드 셀프 서비스
2. 광범위한 네트워크 접근
3. 리소스 풀링
4. 빠른 탄력성
5. 측정 가능한 서비스

### 3. 서비스 모델
- **IaaS**: 인프라 제공 (EC2, VPC)
- **PaaS**: 플랫폼 제공 (RDS, Elastic Beanstalk)
- **SaaS**: 소프트웨어 제공 (Salesforce, WorkSpaces)

### 4. 배포 모델
- **프라이빗 클라우드**: 특정 조직 전용
- **퍼블릭 클라우드**: 누구나 사용 가능 (AWS, Azure, GCP)
- **하이브리드 클라우드**: 프라이빗 + 퍼블릭 연결

### 5. 공동 책임 모델
- **AWS**: 클라우드 인프라 보안 (Security OF the Cloud)
- **고객**: 클라우드 내 리소스 보안 (Security IN the Cloud)
## 🔐 섹션 2: IAM 기초 - AWS 계정 및 권한 관리

### 학습 목표
- AWS 계정과 루트 사용자의 개념 이해
- IAM (Identity and Access Management) 서비스의 역할 파악
- 사용자, 그룹, 정책의 기본 개념 습득
- 보안 모범 사례 (MFA, 비밀번호 정책) 적용 방법 학습

---

### 🔹 AWS 계정 (AWS Account)

#### AWS 계정이란?

**AWS 계정**은 AWS 서비스를 사용하기 위한 **기본 컨테이너**입니다.

```mermaid
graph TB
    subgraph "AWS 클라우드"
        A[AWS 계정]
        A --> B[리소스들]
        B --> C[EC2 인스턴스]
        B --> D[S3 버킷]
        B --> E[RDS 데이터베이스]
        B --> F[VPC 네트워크]

        A --> G[사용자 및 권한]
        G --> H[루트 사용자]
        G --> I[IAM 사용자]
        G --> J[IAM 역할]

        A --> K[결제 정보]
        K --> L[신용카드]
        K --> M[청구서]
    end
```

**AWS 계정의 특징**:
1. **고유 식별자**: 12자리 계정 ID (예: 123456789012)
2. **독립적인 리소스 공간**: 계정마다 별도의 리소스 네임스페이스
3. **독립적인 결제**: 계정별로 별도 청구서 발행
4. **보안 경계**: 기본적으로 다른 계정과 격리됨

#### AWS 계정 생성 시 필요한 정보

```
필수 정보:
1. 이메일 주소 (고유해야 함)
2. 비밀번호
3. 계정 이름
4. 결제 정보 (신용카드 또는 직불카드)
5. 연락처 정보
6. 전화번호 (SMS 인증)
```

💡 **중요**: 이메일 주소는 **AWS 계정의 고유 식별자**로 사용됩니다. 하나의 이메일 주소로는 하나의 AWS 계정만 생성 가능합니다.

#### 계정 생성 후 기본 상태

```
계정 생성 완료
    ↓
루트 사용자 자동 생성
    ↓
초기 권한: 모든 AWS 서비스에 대한 완전한 액세스
    ↓
⚠️ 위험: 루트 사용자는 제한 없는 권한 보유
```

---

### 🔹 루트 사용자 (Root User)

#### 루트 사용자란?

**루트 사용자**는 AWS 계정 생성 시 **자동으로 생성**되는 최고 권한 사용자입니다.

**특징**:
- **무제한 권한**: 모든 AWS 서비스 및 리소스에 대한 완전한 액세스
- **계정당 1개**: 각 AWS 계정마다 정확히 1개의 루트 사용자 존재
- **이메일 로그인**: 계정 생성 시 사용한 이메일 주소로 로그인
- **삭제 불가**: 루트 사용자는 삭제할 수 없음 (계정 삭제만 가능)

#### 루트 사용자 로그인 방법

```
AWS 콘솔 접속 (https://console.aws.amazon.com)
    ↓
"Root user" 선택
    ↓
이메일 주소 입력
    ↓
비밀번호 입력
    ↓
[MFA 설정 시] 인증 코드 입력
    ↓
로그인 완료 (모든 권한 보유)
```

#### 🔐 루트 사용자 보안 권고 사항

AWS는 루트 사용자 사용을 **극도로 제한**할 것을 권장합니다.

**❌ 하지 말아야 할 것**:
1. **일상적인 작업에 루트 사용자 사용 금지**
   - EC2 생성, S3 업로드 등 일반 작업에 사용 금지

2. **액세스 키 생성 금지**
   - 루트 사용자의 프로그래밍 방식 액세스 금지
   - 기존에 생성된 액세스 키가 있다면 **즉시 삭제** 권장

3. **비밀번호 공유 금지**
   - 루트 사용자 인증 정보를 절대 다른 사람과 공유 금지

**✅ 반드시 해야 할 것**:

**1. 강력한 비밀번호 설정**
```
비밀번호 요구사항:
- 최소 8자 이상 (권장: 12자 이상)
- 대문자 포함
- 소문자 포함
- 숫자 포함
- 특수문자 포함

예시:
❌ 약한 비밀번호: password123
✅ 강한 비밀번호: Aws$ecure2025!P@ssw0rd
```

**2. MFA (Multi-Factor Authentication) 활성화** ⭐ **가장 중요!**

MFA는 **2단계 인증**으로, 비밀번호 외에 **추가 인증 단계**를 거치도록 합니다.

```mermaid
sequenceDiagram
    participant U as 사용자
    participant C as AWS 콘솔
    participant M as MFA 디바이스

    U->>C: 1. 이메일 + 비밀번호 입력
    C->>U: 2. MFA 코드 요청
    U->>M: 3. MFA 앱 확인 (Google Authenticator 등)
    M->>U: 4. 6자리 코드 생성 (예: 123456)
    U->>C: 5. 6자리 코드 입력
    C->>U: 6. 로그인 성공 ✅
```

**MFA의 작동 원리**:
```
비밀번호만 사용 (MFA 없음):
    비밀번호 유출 → 계정 탈취 ❌

비밀번호 + MFA 사용:
    비밀번호 유출 → MFA 디바이스 없음 → 로그인 실패 ✅
```

💡 **왜 MFA가 중요한가?**

비밀번호는 여러 방법으로 유출될 수 있습니다:
- 피싱 공격
- 키로거 악성코드
- 데이터베이스 해킹
- 사회공학적 공격

하지만 MFA 디바이스(휴대폰)는 **물리적으로 소유**해야 하므로, 원격에서 탈취하기 매우 어렵습니다.

#### MFA 설정 방법

**Step 1: IAM 대시보드 접속**
```bash
AWS 콘솔 로그인
→ 검색창에 "IAM" 입력
→ IAM 서비스 선택
→ 대시보드 확인
```

**Step 2: 보안 상태 확인**
```
IAM 대시보드에서 "Security recommendations" 확인:

✅ Add MFA for root user (루트 사용자 MFA 추가)
⚠️ [경고 아이콘] MFA가 설정되지 않음
```

**Step 3: MFA 디바이스 유형 선택**

AWS는 3가지 MFA 디바이스 유형을 지원합니다:

| MFA 유형 | 설명 | 장점 | 단점 | 비용 |
|:---|:---|:---|:---|:---:|
| **Authenticator App** | Google Authenticator, Microsoft Authenticator 등 스마트폰 앱 | 무료, 편리 | 휴대폰 분실 시 복구 복잡 | 무료 |
| **Security Key (FIDO)** | YubiKey 등 USB 보안 키 | 가장 안전 | 하드웨어 구매 필요, 분실 위험 | 유료 |
| **Hardware TOTP Token** | 전용 하드웨어 OTP 생성기 | 안전, 휴대폰 불필요 | 비용 발생, 구매 필요 | 유료 |

**권장**: **Authenticator App** (무료이면서 안전)

**Step 4: Authenticator App 설정 (Google Authenticator 예시)**

**4-1. 앱 설치**
```
Android:
    Google Play 스토어 → "Google Authenticator" 검색 → 설치

iOS:
    App Store → "Google Authenticator" 검색 → 설치
```

**4-2. AWS 콘솔에서 MFA 등록**
```
1. IAM 대시보드 → "Add MFA" 클릭
2. MFA device name 입력 (예: "MyiPhone-MFA")
3. "Authenticator app" 선택
4. QR 코드 표시됨
```

**4-3. QR 코드 스캔**
```
1. Google Authenticator 앱 열기
2. "+" 버튼 클릭
3. "Scan QR code" 선택
4. AWS 콘솔의 QR 코드를 스마트폰 카메라로 스캔
5. 6자리 코드 자동 생성 시작 (30초마다 갱신)
```

**4-4. MFA 코드 입력 및 검증**
```
1. AWS 콘솔에서 "MFA code 1" 입력
   (Google Authenticator에 표시된 6자리 코드)

2. 30초 대기 (새로운 코드 생성될 때까지)

3. "MFA code 2" 입력
   (새로 생성된 6자리 코드)

4. "Add MFA" 클릭
5. ✅ MFA 설정 완료!
```

**설정 완료 후 로그인 과정**:
```
로그인 시도:
    이메일 주소 입력
    ↓
    비밀번호 입력
    ↓
    🔒 MFA 코드 요청 화면
    ↓
    Google Authenticator 앱 열기
    ↓
    6자리 코드 확인 (예: 287493)
    ↓
    코드 입력
    ↓
    ✅ 로그인 성공
```

⚠️ **MFA 디바이스 분실 시 복구 방법**:
1. AWS 계정 복구 연락처로 이메일 발송
2. AWS 지원팀에 신원 확인 요청
3. 본인 확인 후 MFA 재설정
4. **권장**: MFA 백업 코드 안전한 곳에 보관

#### 루트 사용자를 사용해야 하는 경우

루트 사용자는 **오직 아래 작업에만** 사용해야 합니다:

1. **계정 설정 변경**
   - 계정 이름 변경
   - 이메일 주소 변경
   - 계정 삭제

2. **결제 정보 관리**
   - 결제 방법 추가/변경
   - 세금 설정
   - AWS Organizations 결제 설정

3. **IAM 정책으로 제한할 수 없는 작업**
   - AWS Support 플랜 변경
   - 특정 마켓플레이스 작업

4. **계정 복구**
   - IAM 사용자 모두 접근 불가 시 복구

💡 **베스트 프랙티스**: 루트 사용자는 **월 1회 이하**로 사용하는 것이 이상적입니다.

---

### 🔹 IAM (Identity and Access Management)

#### IAM이란?

**IAM (Identity and Access Management)**은 AWS 리소스에 대한 **액세스를 안전하게 제어**하는 서비스입니다.

**IAM의 핵심 기능**:
1. **사용자 관리**: 개별 사용자 계정 생성 및 관리
2. **권한 관리**: 누가 무엇을 할 수 있는지 제어
3. **인증**: 사용자 신원 확인 (Authentication)
4. **권한 부여**: 작업 권한 부여 (Authorization)

```mermaid
graph LR
    A[IAM 서비스] --> B[Identity<br/>누구인가?]
    A --> C[Access Management<br/>무엇을 할 수 있는가?]

    B --> D[IAM 사용자]
    B --> E[IAM 그룹]
    B --> F[IAM 역할]

    C --> G[IAM 정책]
    C --> H[권한]
    C --> I[액세스 제어]
```

#### IAM 사용이 필요한 이유

**시나리오**: 개발팀 5명이 AWS 프로젝트를 진행합니다.

**❌ 잘못된 방법 (루트 사용자 공유)**:
```
루트 사용자 이메일: company@example.com
루트 사용자 비밀번호: Aws12345! (모두에게 공유)

문제점:
1. 누가 무엇을 했는지 추적 불가 (감사 로그 혼재)
2. 직원 퇴사 시 비밀번호 변경 필요 (모든 사람에게 영향)
3. 모든 직원이 무제한 권한 보유 (보안 위험)
4. 실수로 중요 리소스 삭제 가능
5. 비밀번호 유출 시 전체 계정 위험
```

**✅ 올바른 방법 (IAM 사용자 사용)**:
```
루트 사용자: 보관만 (MFA 설정, 사용 안 함)

IAM 사용자 생성:
- user-alice (개발자) → 권한: EC2, S3 Read/Write
- user-bob (개발자) → 권한: EC2, S3 Read/Write
- user-charlie (데이터 분석가) → 권한: S3 Read Only, Athena
- user-david (관리자) → 권한: 대부분의 서비스 관리
- user-eve (인턴) → 권한: S3 특정 버킷만 Read Only

장점:
1. 개인별 활동 추적 가능 (CloudTrail 로그)
2. 직원 퇴사 시 해당 사용자만 비활성화
3. 역할에 맞는 최소 권한 부여
4. 비밀번호 유출 시 해당 사용자만 영향
5. 보안 감사 용이
```

#### IAM의 핵심 구성 요소

```mermaid
graph TB
    A[IAM] --> B[사용자<br/>Users]
    A --> C[그룹<br/>Groups]
    A --> D[정책<br/>Policies]
    A --> E[역할<br/>Roles]

    B --> B1[개인 계정]
    B --> B2[고유 자격 증명]
    B --> B3[영구 자격 증명]

    C --> C1[사용자 모음]
    C --> C2[권한 일괄 관리]

    D --> D1[JSON 문서]
    D --> D2[권한 정의]

    E --> E1[임시 자격 증명]
    E --> E2[서비스/애플리케이션용]
```

---

### 🔹 IAM 사용자 (IAM Users)

#### IAM 사용자란?

**IAM 사용자**는 AWS 계정 내에서 생성하는 **개별 사용자 계정**입니다.

**특징**:
- **고유한 이름**: AWS 계정 내에서 유일해야 함
- **영구 자격 증명**: 한 번 생성하면 명시적으로 삭제할 때까지 유지
- **두 가지 액세스 방법**:
  1. **AWS 콘솔 액세스**: 사용자 이름 + 비밀번호
  2. **프로그래밍 방식 액세스**: 액세스 키 + 시크릿 키

#### IAM 사용자 생성 방법

**Step 1: IAM 콘솔 접속**
```
AWS 콘솔 → IAM 서비스 → "Users" 메뉴 클릭
```

**Step 2: 사용자 생성 시작**
```
"Create user" 버튼 클릭
```

**Step 3: 사용자 세부 정보 입력**

**3-1. 사용자 이름 입력**
```
User name: alice-developer

명명 규칙 (권장):
- 소문자 사용
- 역할이나 부서 포함 (예: alice-developer, bob-admin)
- 공백 없이 하이픈(-) 또는 언더스코어(_) 사용
```

**3-2. AWS 콘솔 액세스 설정**
```
☑ Provide user access to the AWS Management Console

액세스 유형 선택:
⚪ I want to create an IAM user
   → IAM 사용자로 콘솔 로그인 가능

⚪ I want to use Identity Center (권장 for 대규모 조직)
   → SSO (Single Sign-On) 사용
```

**3-3. 콘솔 비밀번호 설정**
```
Console password:
⚪ Autogenerated password (자동 생성)
⚪ Custom password (직접 입력)

☑ Users must create a new password at next sign-in (recommended)
   → 첫 로그인 시 비밀번호 변경 강제
```

**Step 4: 권한 설정**

IAM 사용자는 **기본적으로 권한이 없습니다**. 명시적으로 권한을 부여해야 합니다.

**권한 부여 방법 3가지**:

**방법 1: 그룹에 추가 (권장)**
```
Add user to group:
☑ Developers

설명:
- "Developers" 그룹에 alice-developer 추가
- 그룹에 부여된 모든 권한 자동 상속
- 권한 관리 용이 (그룹 권한만 수정하면 모든 멤버에게 적용)
```

**방법 2: 정책 직접 연결**
```
Attach policies directly:
☑ AmazonS3ReadOnlyAccess
☑ AmazonEC2ReadOnlyAccess

설명:
- 사용자에게 정책 직접 연결
- 개별 사용자 맞춤 권한 가능
- 관리 복잡도 증가 (사용자마다 개별 설정)
```

**방법 3: 기존 사용자 권한 복사**
```
Copy permissions from existing user:
    bob-developer

설명:
- bob-developer와 동일한 권한 부여
- 빠른 설정 가능
```

💡 **권장**: **그룹에 추가** 방법 사용 (대부분의 경우 가장 효율적)

**Step 5: 태그 추가 (선택 사항)**
```
Tags (optional):
Key: Department, Value: Engineering
Key: Project, Value: WebApp
Key: CostCenter, Value: CC-1234

용도:
- 리소스 분류
- 비용 추적
- 자동화 스크립트에서 필터링
```

**Step 6: 검토 및 생성**
```
Review and create:
    User name: alice-developer
    AWS access type: Console access
    Permissions: Developers group
    Tags: Department=Engineering

"Create user" 클릭
```

**Step 7: 자격 증명 다운로드** ⚠️ **중요!**
```
사용자 생성 완료 화면:

Console sign-in URL: https://123456789012.signin.aws.amazon.com/console
User name: alice-developer
Console password: AbC123XyZ! (또는 자동 생성된 비밀번호)

⚠️ 이 정보는 한 번만 표시됩니다!

"Download .csv file" 클릭하여 안전한 곳에 보관
```

**Step 8: 사용자에게 전달**
```
Alice에게 이메일 발송:

안녕하세요, Alice님

AWS 계정이 생성되었습니다.

로그인 URL: https://123456789012.signin.aws.amazon.com/console
사용자 이름: alice-developer
임시 비밀번호: AbC123XyZ!

첫 로그인 시 비밀번호를 변경해야 합니다.

권한: EC2 및 S3 읽기/쓰기

질문이 있으시면 연락주세요.

감사합니다.
```

#### IAM 사용자 로그인 URL

**형식**:
```
https://[계정ID].signin.aws.amazon.com/console

또는

https://[계정별칭].signin.aws.amazon.com/console
```

**계정 ID vs 계정 별칭**:

| 항목 | 계정 ID | 계정 별칭 |
|:---|:---|:---|
| **형식** | 12자리 숫자 | 사용자 지정 문자열 |
| **예시** | 123456789012 | mycompany |
| **변경 가능** | ❌ (고정) | ✅ (변경 가능) |
| **기억하기** | 어려움 | 쉬움 |
| **URL** | https://123456789012.signin... | https://mycompany.signin... |

**계정 별칭 설정 방법**:
```
IAM 대시보드 → "AWS Account" 섹션 → "Account Alias"
→ "Create" 클릭
→ 별칭 입력 (예: mycompany-prod)
→ "Save changes"
```

⚠️ **주의**: 계정 별칭은 **전 세계에서 유일**해야 합니다. (이미 다른 AWS 계정이 사용 중이면 사용 불가)

---

### 🔹 IAM 그룹 (IAM Groups)

#### IAM 그룹이란?

**IAM 그룹**은 **IAM 사용자의 모음**입니다.

**목적**:
- 유사한 역할의 사용자들에게 **동일한 권한을 일괄 부여**
- 권한 관리 **간소화**

```mermaid
graph TB
    subgraph "IAM 그룹 구조"
        A[Developers 그룹]
        B[Admins 그룹]
        C[DataAnalysts 그룹]

        A --> A1[alice-dev]
        A --> A2[bob-dev]
        A --> A3[charlie-dev]

        B --> B1[david-admin]
        B --> B2[eve-admin]

        C --> C1[frank-analyst]
        C --> C2[grace-analyst]
    end

    subgraph "권한 (Policies)"
        P1[EC2 Full Access]
        P2[S3 Full Access]
        P3[Administrator Access]
        P4[S3 Read Only]
        P5[Athena Full Access]
    end

    A -.-> P1
    A -.-> P2
    B -.-> P3
    C -.-> P4
    C -.-> P5
```

#### 그룹 사용의 장점

**시나리오**: 5명의 개발자에게 EC2와 S3 권한 부여 필요

**❌ 그룹 미사용 (개별 권한 부여)**:
```
alice-dev: AmazonEC2FullAccess, AmazonS3FullAccess 연결
bob-dev: AmazonEC2FullAccess, AmazonS3FullAccess 연결
charlie-dev: AmazonEC2FullAccess, AmazonS3FullAccess 연결
david-dev: AmazonEC2FullAccess, AmazonS3FullAccess 연결
eve-dev: AmazonEC2FullAccess, AmazonS3FullAccess 연결

문제점:
1. 5번 반복 작업 (비효율적)
2. RDS 권한 추가 필요 시 → 5명 모두 개별 수정 필요
3. 실수로 일부 사용자 누락 가능
4. 권한 일관성 보장 어려움
```

**✅ 그룹 사용**:
```
1. "Developers" 그룹 생성
2. AmazonEC2FullAccess, AmazonS3FullAccess를 그룹에 연결
3. 5명의 사용자를 그룹에 추가

결과:
- 모든 멤버가 자동으로 동일한 권한 보유
- RDS 권한 추가 필요 시 → 그룹에만 1번 추가하면 5명 모두 적용
- 권한 일관성 보장
- 관리 용이
```

#### IAM 그룹 생성 방법

**Step 1: 그룹 생성 시작**
```
IAM 콘솔 → "User groups" → "Create group"
```

**Step 2: 그룹 이름 입력**
```
User group name: Developers

명명 규칙 (권장):
- 역할 기반: Developers, Admins, Auditors
- 부서 기반: Engineering, Marketing, Finance
- 프로젝트 기반: ProjectAlpha, ProjectBeta
```

**Step 3: 정책 연결**
```
Attach permissions policies:

검색창에 "EC2" 입력:
☑ AmazonEC2FullAccess

검색창에 "S3" 입력:
☑ AmazonS3FullAccess

선택된 정책:
- AmazonEC2FullAccess
- AmazonS3FullAccess
```

**Step 4: 그룹 생성 완료**
```
"Create group" 클릭
→ Developers 그룹 생성 완료
```

#### 사용자를 그룹에 추가하는 방법

**방법 1: 사용자 생성 시 그룹 지정**
```
(사용자 생성 과정에서)
Permissions options:
⚪ Add user to group
   → ☑ Developers
```

**방법 2: 기존 사용자를 그룹에 추가**
```
IAM 콘솔 → Users → alice-developer 선택
→ "Groups" 탭 → "Add user to groups"
→ ☑ Developers
→ "Add to groups" 클릭
```

**방법 3: 그룹에서 사용자 추가**
```
IAM 콘솔 → User groups → Developers 선택
→ "Add users" 버튼 클릭
→ ☑ alice-developer
→ ☑ bob-developer
→ "Add users" 클릭
```

#### 그룹 관련 중요 사항

**1. 그룹의 제약 사항**:
- ❌ **그룹은 그룹에 포함될 수 없음** (중첩 불가)
  ```
  잘못된 예:
  AllUsers 그룹
    ↳ Developers 그룹 ❌ (불가능)
        ↳ alice-dev
        ↳ bob-dev
  ```

- ❌ **그룹 자체로는 로그인 불가** (그룹은 권한 관리 도구일 뿐)
  ```
  그룹: Developers
  → 로그인 불가 ❌

  사용자: alice-dev (Developers 그룹 멤버)
  → 로그인 가능 ✅
  ```

**2. 사용자는 여러 그룹에 속할 수 있음**:
```
alice-dev:
    ↳ Developers 그룹 (EC2, S3 권한)
    ↳ Auditors 그룹 (CloudTrail 읽기 권한)

결과: alice-dev는 두 그룹의 권한을 모두 보유
```

**3. 권한의 합집합**:
```
alice-dev의 최종 권한 =
    Developers 그룹 권한 ∪ Auditors 그룹 권한 ∪ 개별 부여 권한

예시:
- Developers: EC2 Full, S3 Full
- Auditors: CloudTrail Read
- 개별 부여: RDS Read

최종 권한: EC2 Full + S3 Full + CloudTrail Read + RDS Read
```

---

### 🔹 IAM 정책 (IAM Policies) 기초

#### IAM 정책이란?

**IAM 정책**은 **권한을 정의하는 JSON 문서**입니다.

**핵심 개념**:
- 누가 (Principal)
- 어떤 리소스에 대해 (Resource)
- 어떤 작업을 (Action)
- 허용 또는 거부할지 (Effect: Allow/Deny)

#### 정책의 기본 구조

```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": "s3:GetObject",
      "Resource": "arn:aws:s3:::my-bucket/*"
    }
  ]
}
```

**각 필드 설명**:

| 필드 | 설명 | 필수 여부 | 예시 |
|:---|:---|:---:|:---|
| **Version** | 정책 언어 버전 | ✅ | "2012-10-17" (현재 최신) |
| **Statement** | 권한 규칙 배열 | ✅ | 여러 개의 규칙 포함 가능 |
| **Effect** | 허용/거부 | ✅ | "Allow" 또는 "Deny" |
| **Action** | AWS API 작업 | ✅ | "s3:GetObject", "ec2:*" |
| **Resource** | 대상 리소스 | 조건부 | ARN 형식 |
| **Condition** | 추가 조건 | ❌ | IP 제한, 시간 제한 등 |

#### 정책 예시

**예시 1: S3 버킷 읽기 전용 권한**
```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": [
        "s3:GetObject",
        "s3:ListBucket"
      ],
      "Resource": [
        "arn:aws:s3:::my-company-data",
        "arn:aws:s3:::my-company-data/*"
      ]
    }
  ]
}
```

**해석**:
- `s3:GetObject`: S3 객체 다운로드 가능
- `s3:ListBucket`: S3 버킷 목록 조회 가능
- `my-company-data` 버킷 및 모든 객체 (`/*`)에 대해 적용

**예시 2: EC2 인스턴스 시작/중지 권한**
```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": [
        "ec2:StartInstances",
        "ec2:StopInstances",
        "ec2:DescribeInstances"
      ],
      "Resource": "*"
    }
  ]
}
```

**해석**:
- EC2 인스턴스 시작 가능
- EC2 인스턴스 중지 가능
- EC2 인스턴스 목록 조회 가능
- 모든 EC2 인스턴스 (`*`)에 대해 적용

#### 관리형 정책 vs 인라인 정책

**1. AWS 관리형 정책 (AWS Managed Policies)**

AWS가 미리 만들어 제공하는 정책입니다.

**특징**:
- ✅ AWS가 관리 및 업데이트 (자동으로 최신 상태 유지)
- ✅ 일반적인 사용 사례 커버
- ✅ 바로 사용 가능
- ❌ 수정 불가 (읽기 전용)

**예시**:
- `AmazonS3ReadOnlyAccess`: S3 읽기 전용
- `AmazonEC2FullAccess`: EC2 모든 권한
- `AdministratorAccess`: 모든 AWS 서비스 모든 권한
- `PowerUserAccess`: AdministratorAccess - IAM 권한
- `ReadOnlyAccess`: 모든 AWS 서비스 읽기 전용

**2. 고객 관리형 정책 (Customer Managed Policies)**

고객(사용자)이 직접 생성하고 관리하는 정책입니다.

**특징**:
- ✅ 완전한 커스터마이징 가능
- ✅ 여러 사용자/그룹/역할에 재사용 가능
- ✅ 버전 관리 지원 (변경 이력 추적)
- ❌ 직접 관리 필요

**사용 시나리오**:
```
상황: 개발팀은 특정 S3 버킷만 접근 가능해야 함

AWS 관리형 정책:
- AmazonS3FullAccess → 너무 넓은 권한 (모든 S3 버킷)
- AmazonS3ReadOnlyAccess → 너무 제한적 (쓰기 불가)

해결책: 고객 관리형 정책 생성
→ 특정 버킷에 대한 읽기/쓰기 권한만 부여
```

**3. 인라인 정책 (Inline Policies)**

특정 사용자/그룹/역할에 **직접 포함**되는 정책입니다.

**특징**:
- ✅ 1:1 관계 (해당 엔티티 삭제 시 정책도 자동 삭제)
- ✅ 매우 특수한 권한 부여 시 유용
- ❌ 재사용 불가
- ❌ 관리 복잡도 증가

**사용 시나리오**:
```
상황: alice-dev만 특정 Lambda 함수를 삭제할 수 있어야 함

해결책: alice-dev에게만 인라인 정책 직접 연결
→ alice-dev 삭제 시 이 권한도 자동 삭제 (불필요한 정책 남지 않음)
```

💡 **권장 사용 순서**:
1. **AWS 관리형 정책** 먼저 확인 (있으면 사용)
2. 없으면 **고객 관리형 정책** 생성 (재사용 가능)
3. 매우 특수한 경우에만 **인라인 정책** 사용

---

### 🔹 액세스 키 (Access Keys)

#### 액세스 키란?

**액세스 키**는 **프로그래밍 방식으로 AWS에 접근**할 때 사용하는 자격 증명입니다.

**구성**:
```
Access Key ID: AKIAIOSFODNN7EXAMPLE (20자)
Secret Access Key: wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY (40자)

비유:
    Access Key ID = 사용자 이름 (공개 가능)
    Secret Access Key = 비밀번호 (절대 공개 금지)
```

#### 액세스 키 사용 시나리오

**시나리오 1: AWS CLI 사용**
```bash
# AWS CLI 설치 후 자격 증명 설정
$ aws configure
AWS Access Key ID [None]: AKIAIOSFODNN7EXAMPLE
AWS Secret Access Key [None]: wJalrXUtnFEMI/K7MDENG...
Default region name [None]: ap-northeast-2
Default output format [None]: json

# EC2 인스턴스 목록 조회
$ aws ec2 describe-instances

# S3 버킷 생성
$ aws s3 mb s3://my-new-bucket
```

**시나리오 2: SDK (Python Boto3) 사용**
```python
import boto3

# 자격 증명 설정
s3 = boto3.client(
    's3',
    aws_access_key_id='AKIAIOSFODNN7EXAMPLE',
    aws_secret_access_key='wJalrXUtnFEMI/K7MDENG...'
)

# S3 버킷 목록 조회
response = s3.list_buckets()
print('S3 버킷 목록:')
for bucket in response['Buckets']:
    print(f'  - {bucket["Name"]}')
```

**시나리오 3: 서드파티 도구 연동**
```
Terraform, Ansible, Jenkins 등의 도구에서
AWS 리소스를 프로비저닝할 때 액세스 키 사용

예: Terraform 설정
provider "aws" {
  access_key = "AKIAIOSFODNN7EXAMPLE"
  secret_key = "wJalrXUtnFEMI/K7MDENG..."
  region     = "ap-northeast-2"
}
```

#### 액세스 키 생성 방법

**Step 1: 사용자 선택**
```
IAM 콘솔 → Users → alice-developer 선택
→ "Security credentials" 탭 클릭
```

**Step 2: 액세스 키 생성**
```
"Access keys" 섹션
→ "Create access key" 버튼 클릭
```

**Step 3: 사용 사례 선택**
```
Select use case:
⚪ Command Line Interface (CLI)
⚪ Local code
⚪ Application running on AWS compute service
⚪ Application running outside AWS
⚪ Other

"CLI" 선택 (가장 일반적)
```

**Step 4: 확인 체크박스**
```
☑ I understand the above recommendation and want to proceed to create an access key.

"Next" 클릭
```

**Step 5: 설명 태그 추가 (선택사항)**
```
Description tag (optional): CLI for local development

"Create access key" 클릭
```

**Step 6: 자격 증명 다운로드** ⚠️ **매우 중요!**
```
✅ Access key 생성 완료!

Access key ID: AKIAIOSFODNN7EXAMPLE
Secret access key: wJalrXUtnFEMI/K7MDENG... (표시됨)

⚠️ 이 페이지를 닫으면 Secret access key를 다시 볼 수 없습니다!

"Download .csv file" 클릭 (필수!)
```

**생성된 CSV 파일 내용**:
```csv
Access key ID,Secret access key
AKIAIOSFODNN7EXAMPLE,wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY
```

⚠️ **이 파일을 안전한 곳에 보관하세요!**

#### 🔐 액세스 키 보안 모범 사례

**1. 절대 하드코딩하지 마세요**

**❌ 잘못된 예 (소스코드에 하드코딩)**:
```python
# app.py
import boto3

s3 = boto3.client(
    's3',
    aws_access_key_id='AKIAIOSFODNN7EXAMPLE',  # ❌ 위험!
    aws_secret_access_key='wJalrXUtnFEMI...'   # ❌ 위험!
)
```

**위험 사항**:
- GitHub에 푸시 시 **전 세계에 공개**됨
- 자동화된 봇이 **몇 분 내에 탐지**하여 악용
- 수백만 원의 요금 폭탄 가능

**✅ 올바른 방법 1: 환경 변수 사용**
```bash
# .bashrc 또는 .zshrc에 추가
export AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMPLE
export AWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI...
```

```python
# app.py
import boto3

# 환경 변수에서 자동으로 자격 증명 읽음
s3 = boto3.client('s3')  # ✅ 안전!
```

**✅ 올바른 방법 2: AWS CLI 설정 파일 사용**
```bash
# ~/.aws/credentials 파일
[default]
aws_access_key_id = AKIAIOSFODNN7EXAMPLE
aws_secret_access_key = wJalrXUtnFEMI...
```

```python
# app.py
import boto3

# credentials 파일에서 자동으로 읽음
s3 = boto3.client('s3')  # ✅ 안전!
```

**✅ 올바른 방법 3: IAM 역할 사용 (EC2에서 실행 시)**
```
EC2 인스턴스에 IAM 역할 연결
→ 액세스 키 불필요
→ 자동으로 임시 자격 증명 발급
```

**2. 주기적으로 액세스 키 교체**
```
권장 주기: 90일마다 교체

교체 절차:
1. 새 액세스 키 생성 (최대 2개까지 가능)
2. 애플리케이션에서 새 키 테스트
3. 정상 작동 확인 후 기존 키 비활성화
4. 7일 후 문제 없으면 기존 키 삭제
```

**3. 최소 권한 부여**
```
❌ AdministratorAccess 권한의 액세스 키
✅ 필요한 최소 권한만 부여

예: S3만 사용하는 애플리케이션
    → AmazonS3FullAccess 권한만 부여
```

**4. 루트 사용자 액세스 키는 절대 생성 금지**
```
루트 사용자 액세스 키:
    - 무제한 권한
    - 유출 시 계정 완전 탈취
    - AWS 권장사항: 생성 금지

기존에 생성되어 있다면:
    → 즉시 삭제 권장
```

**5. Git에 커밋하지 않도록 .gitignore 설정**
```bash
# .gitignore
.env
.aws/
credentials
*.csv
config.json
```

---

### 🔹 비밀번호 정책 (Password Policy)

#### 비밀번호 정책이란?

**비밀번호 정책**은 IAM 사용자의 **비밀번호 규칙**을 정의합니다.

**목적**:
- 약한 비밀번호 사용 방지
- 정기적인 비밀번호 변경 강제
- 비밀번호 재사용 방지

#### 비밀번호 정책 설정 방법

**Step 1: IAM 대시보드 접속**
```
IAM 콘솔 → "Account settings" (왼쪽 메뉴)
```

**Step 2: 비밀번호 정책 편집**
```
Password policy 섹션
→ "Edit" 버튼 클릭
```

**Step 3: 정책 옵션 설정**

**기본 설정 (Default policy)**:
```
Minimum password length: 8 characters
No complexity requirements
Never expire
```

**커스텀 설정 (Custom)**:

**1. 비밀번호 길이**
```
☑ Enforce minimum password length
    Minimum length: [12] characters

권장: 최소 12자 이상
```

**2. 복잡성 요구사항**
```
☑ Require at least one uppercase letter (A-Z)
☑ Require at least one lowercase letter (a-z)
☑ Require at least one number (0-9)
☑ Require at least one non-alphanumeric character (!@#$%^&*)

결과: 대소문자, 숫자, 특수문자 모두 포함 필수
```

**3. 비밀번호 만료**
```
☑ Enable password expiration
    Password expiration period: [90] days

권장: 90일마다 변경
```

**4. 비밀번호 재사용 방지**
```
☑ Prevent password reuse
    Remember last [5] passwords

결과: 최근 5개의 비밀번호는 재사용 불가
```

**5. 비밀번호 변경 권한**
```
☑ Allow users to change their own password

결과: 사용자가 스스로 비밀번호 변경 가능
```

**6. 비밀번호 만료 시 재설정 필요**
```
☑ Require administrator reset upon password expiration

결과: 만료 후 관리자가 재설정해야 함 (선택사항, 보통 체크 안 함)
```

**Step 4: 저장**
```
"Save changes" 클릭
→ 모든 IAM 사용자에게 즉시 적용
```

#### 권장 비밀번호 정책

**일반 기업 환경**:
```
- 최소 길이: 12자
- 복잡성: 대소문자 + 숫자 + 특수문자
- 만료: 90일
- 재사용 방지: 최근 5개
- 사용자 변경 허용: ✅
```

**보안 강화 환경 (금융, 의료 등)**:
```
- 최소 길이: 16자
- 복잡성: 대소문자 + 숫자 + 특수문자
- 만료: 60일
- 재사용 방지: 최근 10개
- 사용자 변경 허용: ✅
- MFA 필수: ✅
```

---

## ✅ 섹션 2 학습 체크리스트

- [ ] AWS 계정과 루트 사용자의 차이를 이해한다
- [ ] 루트 사용자에 MFA를 설정할 수 있다
- [ ] IAM 사용자를 생성할 수 있다
- [ ] IAM 그룹을 생성하고 사용자를 추가할 수 있다
- [ ] IAM 정책의 기본 구조를 이해한다
- [ ] 액세스 키를 안전하게 관리하는 방법을 안다
- [ ] 비밀번호 정책을 설정할 수 있다

---

## 📋 섹션 2 핵심 요약

### 1. AWS 계정 및 루트 사용자
- **AWS 계정**: AWS 서비스 사용을 위한 기본 컨테이너
- **루트 사용자**: 계정 생성 시 자동 생성, 무제한 권한
- **보안 권장사항**:
  - MFA 활성화 (필수)
  - 일상 작업에 사용 금지
  - 액세스 키 생성 금지

### 2. IAM 서비스
- **목적**: 계정 및 권한 안전하게 관리
- **구성 요소**:
  - **사용자**: 개인 계정
  - **그룹**: 사용자 모음 (권한 일괄 관리)
  - **정책**: JSON 형식의 권한 정의
  - **역할**: 임시 자격 증명 (다음 섹션에서 학습)

### 3. MFA (Multi-Factor Authentication)
- **2단계 인증**: 비밀번호 + 추가 인증
- **지원 방식**:
  - Authenticator App (권장, 무료)
  - Security Key (FIDO)
  - Hardware TOTP Token
- **루트 사용자 및 IAM 사용자 모두 설정 가능**

### 4. 액세스 키
- **용도**: 프로그래밍 방식 AWS 접근 (CLI, SDK)
- **구성**: Access Key ID + Secret Access Key
- **보안 수칙**:
  - 절대 하드코딩 금지
  - 주기적 교체 (90일 권장)
  - 최소 권한 부여
  - 루트 사용자 액세스 키 생성 금지

### 5. 비밀번호 정책
- **최소 길이**: 12자 이상 권장
- **복잡성**: 대소문자 + 숫자 + 특수문자
- **만료**: 90일 권장
- **재사용 방지**: 최근 5개
## 🎓 섹션 3: IAM 심화 - 역할, 정책, Organizations

### 학습 목표
- IAM 역할(Role)의 개념과 사용 사례 이해
- 자격증명 기반 정책 vs 리소스 기반 정책 구분
- Permission Boundary의 작동 원리 파악
- SCP (Service Control Policy)와 Organizations 이해
- 다중 계정 전략 및 관리 방법 학습

---

### 🔹 IAM 역할 (IAM Roles)

#### IAM 역할이란?

**IAM 역할**은 **임시 자격 증명**을 제공하는 IAM 엔티티입니다.

**IAM 사용자 vs IAM 역할 비교**:

| 특성 | IAM 사용자 | IAM 역할 |
|:---|:---|:---|
| **자격 증명 유형** | 영구적 (Permanent) | 임시적 (Temporary) |
| **대상** | 특정 개인 | 서비스, 애플리케이션, 계정 |
| **로그인 방식** | 사용자 이름 + 비밀번호 | Assume Role (역할 위임) |
| **액세스 키** | 영구 액세스 키 | 임시 보안 토큰 (만료됨) |
| **사용 사례** | 개인이 AWS 콘솔/CLI 사용 | EC2, Lambda, 교차 계정 접근 |

#### 역할의 주요 사용 사례

**사용 사례 1: EC2 인스턴스에 권한 부여 (인스턴스 프로파일)**

```mermaid
sequenceDiagram
    participant EC2 as EC2 인스턴스
    participant Role as IAM 역할<br/>(EC2-S3-Role)
    participant S3 as S3 버킷

    Note over EC2: 애플리케이션 실행 중
    EC2->>Role: 임시 자격 증명 요청
    Role->>EC2: 임시 Access Key 발급<br/>(60분 유효)
    EC2->>S3: S3 PutObject 요청<br/>(임시 자격 증명 사용)
    S3->>EC2: 업로드 성공
    Note over EC2: 60분 후 자동으로 새 자격 증명 획득
```

**시나리오**:
```
상황: EC2 인스턴스에서 실행되는 웹 애플리케이션이
     S3 버킷에 파일을 업로드해야 함

❌ 잘못된 방법:
    액세스 키를 EC2에 하드코딩
    → 유출 위험, 키 교체 어려움

✅ 올바른 방법:
    1. S3 Full Access 권한을 가진 IAM 역할 생성
    2. EC2 인스턴스에 역할 연결 (인스턴스 프로파일)
    3. 애플리케이션이 자동으로 임시 자격 증명 획득
    4. S3에 안전하게 파일 업로드
```

**역할 생성 단계**:
```
Step 1: IAM 콘솔 → Roles → Create role

Step 2: Trusted entity type 선택
    ⚪ AWS service (EC2, Lambda 등)
    ⚪ AWS account (교차 계정 액세스)
    ⚪ Web identity (소셜 로그인)
    ⚪ SAML 2.0 federation (기업 SSO)
    ⚪ Custom trust policy (수동 설정)

    → "AWS service" 선택

Step 3: Use case 선택
    Service: EC2
    Use case: EC2
    → Next

Step 4: 권한 정책 연결
    검색: "S3"
    ☑ AmazonS3FullAccess
    → Next

Step 5: Role name 입력
    Role name: EC2-S3-FullAccess-Role
    Description: Allows EC2 to access S3 buckets
    → Create role

Step 6: EC2에 역할 연결
    EC2 콘솔 → 인스턴스 선택
    → Actions → Security → Modify IAM role
    → EC2-S3-FullAccess-Role 선택
    → Update IAM role
```

**애플리케이션 코드 (Python)**:
```python
import boto3

# 역할이 연결된 EC2에서 실행 시
# 자동으로 임시 자격 증명 사용 (액세스 키 불필요!)
s3 = boto3.client('s3')

# S3에 파일 업로드
s3.upload_file(
    Filename='/tmp/data.csv',
    Bucket='my-company-bucket',
    Key='uploads/data.csv'
)

print("파일 업로드 성공!")
```

💡 **핵심**: 액세스 키를 코드에 넣지 않아도 자동으로 작동합니다!

---

**사용 사례 2: 교차 계정 액세스 (Cross-Account Access)**

```mermaid
graph LR
    subgraph "계정 A (123456789012)"
        U[IAM 사용자: alice]
    end

    subgraph "계정 B (987654321098)"
        R[IAM 역할: CrossAccountRole]
        E[EC2 인스턴스]
    end

    U -->|1. Assume Role| R
    R -->|2. 임시 자격 증명| U
    U -->|3. EC2 관리| E
```

**시나리오**:
```
상황: 회사에 2개의 AWS 계정 존재
    - 계정 A: IAM 사용자 관리 전용 (alice 사용자 존재)
    - 계정 B: 프로덕션 리소스 (EC2, RDS 등)

목표: alice가 계정 B의 EC2를 관리해야 함

해결책: 교차 계정 역할 사용
    1. 계정 B에 "CrossAccountRole" 생성
    2. 신뢰 정책에 계정 A를 추가
    3. alice가 "Assume Role"로 임시 권한 획득
    4. 계정 B의 리소스에 접근
```

**역할 생성 (계정 B에서)**:
```
Step 1: IAM → Roles → Create role

Step 2: Trusted entity type
    → "AWS account" 선택

Step 3: Account ID 입력
    Account ID: 123456789012 (계정 A)
    ☑ Require MFA (권장)

Step 4: 권한 부여
    ☑ AmazonEC2FullAccess

Step 5: Role name
    Role name: CrossAccountEC2Role
    → Create role
```

**신뢰 정책 (Trust Policy) 확인**:
```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Principal": {
        "AWS": "arn:aws:iam::123456789012:root"
      },
      "Action": "sts:AssumeRole",
      "Condition": {
        "Bool": {
          "aws:MultiFactorAuthPresent": "true"
        }
      }
    }
  ]
}
```

**해석**:
- `Principal`: 계정 A (123456789012)가 이 역할을 사용할 수 있음
- `Action`: `sts:AssumeRole` (역할 위임)
- `Condition`: MFA 인증 필요

**alice가 역할 사용하는 방법**:
```bash
# AWS CLI에서 역할 위임
$ aws sts assume-role \
  --role-arn arn:aws:iam::987654321098:role/CrossAccountEC2Role \
  --role-session-name alice-session \
  --serial-number arn:aws:iam::123456789012:mfa/alice \
  --token-code 123456

# 응답 (임시 자격 증명)
{
  "Credentials": {
    "AccessKeyId": "ASIATEMPORARY12345",
    "SecretAccessKey": "wJalr...",
    "SessionToken": "FwoGZX...",
    "Expiration": "2025-12-04T18:00:00Z"
  }
}

# 임시 자격 증명으로 EC2 조회
$ export AWS_ACCESS_KEY_ID=ASIATEMPORARY12345
$ export AWS_SECRET_ACCESS_KEY=wJalr...
$ export AWS_SESSION_TOKEN=FwoGZX...

$ aws ec2 describe-instances
# 계정 B의 EC2 목록 표시됨!
```

---

**사용 사례 3: Lambda 함수에 권한 부여**

```
Lambda 함수: ProcessS3Files
역할: Lambda-S3-DynamoDB-Role
권한:
    - S3 Read (파일 읽기)
    - DynamoDB Write (데이터 저장)

작동 과정:
    1. S3에 새 파일 업로드됨
    2. Lambda 함수 자동 트리거
    3. Lambda가 역할의 임시 자격 증명 획득
    4. S3에서 파일 다운로드
    5. DynamoDB에 데이터 저장
```

---

### 🔹 정책 유형

#### 1. 자격증명 기반 정책 (Identity-based Policies)

**누구에게 연결**: IAM 사용자, 그룹, 역할

**특징**: "이 주체가 무엇을 할 수 있는가"

**예시**:
```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": [
        "s3:GetObject",
        "s3:PutObject"
      ],
      "Resource": "arn:aws:s3:::my-bucket/*"
    }
  ]
}
```

#### 2. 리소스 기반 정책 (Resource-based Policies)

**어디에 연결**: S3 버킷, SQS 큐, Lambda 함수 등 리소스

**특징**: "이 리소스에 누가 접근할 수 있는가"

**예시 (S3 버킷 정책)**:
```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Principal": {
        "AWS": "arn:aws:iam::123456789012:user/alice"
      },
      "Action": "s3:GetObject",
      "Resource": "arn:aws:s3:::public-data/*"
    }
  ]
}
```

**차이점**:

| 구분 | 자격증명 기반 정책 | 리소스 기반 정책 |
|:---|:---|:---|
| **연결 대상** | IAM 엔티티 (사용자, 역할) | AWS 리소스 (S3, SQS 등) |
| **관점** | "내가 무엇을 할 수 있나?" | "누가 나에게 접근할 수 있나?" |
| **Principal 지정** | 불필요 (연결된 엔티티가 주체) | 필수 (누가 접근하는지 명시) |
| **교차 계정** | Assume Role 필요 | 직접 허용 가능 |

---

### 🔹 Permission Boundary (권한 경계)

#### Permission Boundary란?

**Permission Boundary**는 IAM 엔티티(사용자/역할)의 **최대 권한을 제한**하는 기능입니다.

**작동 원리**:
```
최종 권한 = 자격증명 정책 ∩ Permission Boundary

예시:
    자격증명 정책: EC2 Full, S3 Full, RDS Full
    Permission Boundary: S3 Full, DynamoDB Full

    최종 권한 = S3 Full 만 허용
    (교집합만 유효)
```

```mermaid
graph TB
    subgraph "권한 결정 과정"
        A[자격증명 정책<br/>EC2, S3, RDS]
        B[Permission Boundary<br/>S3, DynamoDB]
        C[최종 유효 권한<br/>S3 만]
    end

    A --> C
    B --> C
```

**사용 사례**:
```
상황: 관리자가 개발자들에게 IAM 사용자 생성 권한 부여
    하지만, 개발자가 자신에게 Administrator 권한 부여하는 것 방지

해결책:
    1. 개발자에게 IAM 사용자 생성 권한 부여
    2. Permission Boundary 설정: EC2, S3, RDS만 허용
    3. 개발자가 새 사용자 생성 시 자동으로 Boundary 적용
    4. 결과: 개발자가 만든 사용자는 최대 EC2, S3, RDS만 사용 가능
```

---

### 🔹 AWS Organizations 및 SCP

#### AWS Organizations란?

**AWS Organizations**는 여러 AWS 계정을 **중앙에서 관리**하는 서비스입니다.

```mermaid
graph TB
    Root[관리 계정<br/>Management Account]
    Root --> OU1[Production OU]
    Root --> OU2[Development OU]
    Root --> OU3[Security OU]

    OU1 --> A1[계정: prod-web]
    OU1 --> A2[계정: prod-api]

    OU2 --> A3[계정: dev-sandbox]
    OU2 --> A4[계정: dev-test]

    OU3 --> A5[계정: security-logging]

    SCP1[SCP: Production-Policy] -.-> OU1
    SCP2[SCP: Dev-Policy] -.-> OU2
```

#### SCP (Service Control Policy)

**SCP**는 **조직 단위(OU) 또는 계정의 최대 권한을 제한**합니다.

**작동 원리**:
```
최종 권한 = 자격증명 정책 ∩ Permission Boundary ∩ SCP

예시:
    사용자의 자격증명 정책: EC2 Full, S3 Full, RDS Full
    Permission Boundary: S3 Full, RDS Full, DynamoDB Full
    SCP (OU 레벨): S3 Full, Lambda Full

    최종 권한 = S3 Full 만
```

**SCP 예시 (특정 리전 제한)**:
```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Deny",
      "Action": "*",
      "Resource": "*",
      "Condition": {
        "StringNotEquals": {
          "aws:RequestedRegion": [
            "ap-northeast-2",
            "us-east-1"
          ]
        }
      }
    }
  ]
}
```

**효과**: 서울(ap-northeast-2)과 버지니아(us-east-1) 리전만 사용 가능

---

## ✅ 섹션 3 학습 체크리스트

- [ ] IAM 역할의 작동 원리를 이해한다
- [ ] EC2에 역할을 연결할 수 있다
- [ ] 교차 계정 액세스 구조를 이해한다
- [ ] 자격증명 정책과 리소스 정책의 차이를 안다
- [ ] Permission Boundary의 용도를 이해한다
- [ ] AWS Organizations 및 SCP의 역할을 안다

---

## 📋 섹션 3 핵심 요약

### 1. IAM 역할
- **임시 자격 증명** 제공
- 주요 사용 사례:
  - EC2 인스턴스 권한 부여
  - Lambda 함수 권한 부여
  - 교차 계정 액세스

### 2. 정책 유형
- **자격증명 기반**: IAM 엔티티에 연결
- **리소스 기반**: AWS 리소스에 연결

### 3. 권한 제한 메커니즘
- **Permission Boundary**: 개별 사용자/역할의 최대 권한 제한
- **SCP**: 조직 단위/계정의 최대 권한 제한

### 4. AWS Organizations
- 다중 계정 중앙 관리
- 통합 결제
- SCP로 계정별 권한 제어
## 🌐 섹션 4: 네트워크 기초 복습

### 학습 목표
- TCP/IP 네트워크 기본 개념 복습
- IP 주소, 서브넷, CIDR 표기법 이해
- 라우팅과 라우팅 테이블의 작동 원리 파악
- DNS의 동작 방식 이해
- 방화벽 및 로드 밸런싱 개념 복습

---

### 🔹 IP 주소 (IP Address)

#### IP 주소란?

**IP 주소**는 네트워크상에서 디바이스를 식별하는 **고유한 주소**입니다.

**형식**:
```
IPv4: 192.168.1.10
    - 32비트 (4바이트)
    - 4개의 옥텟 (0-255)
    - 약 43억 개 주소

IPv6: 2001:0db8:85a3:0000:0000:8a2e:0370:7334
    - 128비트 (16바이트)
    - 16진수 표기
    - 거의 무한한 주소
```

#### 공인 IP vs 사설 IP

| 구분 | 공인 IP (Public IP) | 사설 IP (Private IP) |
|:---|:---|:---|
| **용도** | 인터넷 통신 | 내부 네트워크 통신 |
| **고유성** | 전 세계적으로 유일 | 로컬 네트워크 내에서만 유일 |
| **할당** | ISP가 할당 | 관리자가 자유롭게 할당 |
| **인터넷 접근** | 직접 가능 | NAT 필요 |
| **예시** | 13.124.45.67 | 192.168.1.10 |

**사설 IP 주소 범위** (RFC 1918):
```
Class A: 10.0.0.0 ~ 10.255.255.255 (10.0.0.0/8)
Class B: 172.16.0.0 ~ 172.31.255.255 (172.16.0.0/12)
Class C: 192.168.0.0 ~ 192.168.255.255 (192.168.0.0/16)
```

💡 **AWS VPC는 사설 IP 주소 범위를 사용**합니다.

---

### 🔹 서브넷 (Subnet)

#### 서브넷이란?

**서브넷**은 큰 네트워크를 **더 작은 논리적 단위로 분할**한 것입니다.

**예시**:
```
전체 네트워크: 10.0.0.0/16 (65,536개 IP)
    ↓
서브넷 1: 10.0.1.0/24 (256개 IP)
서브넷 2: 10.0.2.0/24 (256개 IP)
서브넷 3: 10.0.3.0/24 (256개 IP)
서브넷 4: 10.0.4.0/24 (256개 IP)
```

**왜 서브넷을 나누는가?**:
1. **보안**: 부서별/역할별 네트워크 격리
2. **관리**: 논리적 그룹화로 관리 용이
3. **성능**: 브로드캐스트 도메인 축소
4. **효율성**: IP 주소 효율적 사용

---

### 🔹 CIDR 표기법

#### CIDR (Classless Inter-Domain Routing)

**CIDR**은 IP 주소 범위를 **간결하게 표현**하는 방법입니다.

**형식**: `IP주소/프리픽스길이`

**예시**:
```
10.0.1.0/24
    ↓
10.0.1.0: 네트워크 주소
/24: 앞의 24비트가 네트워크 부분
    뒤의 8비트가 호스트 부분 (2^8 = 256개)
```

**CIDR 프리픽스 길이와 IP 개수**:

| CIDR | 네트워크 비트 | 호스트 비트 | 사용 가능 IP 수 | 예시 |
|:---:|:---:|:---:|:---:|:---|
| /32 | 32 | 0 | 1개 | 단일 호스트 |
| /28 | 28 | 4 | 16개 | 작은 서브넷 |
| /24 | 24 | 8 | 256개 | 일반적인 서브넷 |
| /20 | 20 | 12 | 4,096개 | 중규모 네트워크 |
| /16 | 16 | 16 | 65,536개 | 대규모 네트워크 (VPC) |

**계산 방법**:
```
10.0.1.0/24의 IP 범위:

1. /24 = 24비트 네트워크, 8비트 호스트
2. 2^8 = 256개 IP
3. 범위: 10.0.1.0 ~ 10.0.1.255

네트워크 주소: 10.0.1.0 (사용 불가)
브로드캐스트 주소: 10.0.1.255 (사용 불가)
사용 가능: 10.0.1.1 ~ 10.0.1.254 (254개)
```

---

### 🔹 라우팅 (Routing)

#### 라우팅이란?

**라우팅**은 패킷을 **목적지까지 전달하는 경로를 결정**하는 과정입니다.

```mermaid
graph LR
    A[출발지<br/>192.168.1.10] -->|라우터 1| B[라우터 1<br/>경로 결정]
    B -->|라우터 2| C[라우터 2<br/>경로 결정]
    C -->|최종 라우터| D[목적지<br/>13.124.45.67]
```

#### 라우팅 테이블 (Routing Table)

**라우팅 테이블**은 **패킷을 어디로 보낼지 정의한 규칙 모음**입니다.

**라우팅 테이블 예시**:

| 목적지 (Destination) | 넷마스크 | 게이트웨이 (Gateway) | 인터페이스 |
|:---|:---|:---|:---|
| 10.0.1.0 | /24 | Local | eth0 |
| 10.0.2.0 | /24 | Local | eth1 |
| 0.0.0.0 | /0 | 10.0.1.1 | eth0 |

**해석**:
```
규칙 1: 10.0.1.0/24로 가는 패킷
    → Local (직접 연결된 네트워크)

규칙 2: 10.0.2.0/24로 가는 패킷
    → Local (직접 연결된 네트워크)

규칙 3: 나머지 모든 목적지 (0.0.0.0/0 = Default Route)
    → 게이트웨이 10.0.1.1로 전달
```

💡 **AWS VPC의 라우팅 테이블**:
```
목적지: 10.0.0.0/16 → Target: local
    (VPC 내부 통신)

목적지: 0.0.0.0/0 → Target: igw-1234abcd
    (인터넷 통신, 인터넷 게이트웨이로)
```

---

### 🔹 DNS (Domain Name System)

#### DNS란?

**DNS**는 **도메인 이름을 IP 주소로 변환**하는 시스템입니다.

**작동 과정** (Name Resolution):

```mermaid
sequenceDiagram
    participant C as 클라이언트
    participant L as 로컬 DNS
    participant R as Root DNS
    participant T as .com DNS
    participant A as google.com DNS

    C->>L: www.google.com IP 주소는?
    L->>R: www.google.com IP 주소는?
    R->>L: .com DNS 서버 주소 알려줌
    L->>T: www.google.com IP 주소는?
    T->>L: google.com DNS 서버 주소 알려줌
    L->>A: www.google.com IP 주소는?
    A->>L: 142.250.196.100
    L->>C: 142.250.196.100
    Note over C: 웹 브라우저가 142.250.196.100으로 접속
```

**단계별 설명**:
```
1. 사용자: www.google.com 입력
2. 클라이언트: 로컬 DNS 서버에 질의
3. 로컬 DNS: 캐시 확인 (없으면 Root DNS에 질의)
4. Root DNS: ".com" DNS 서버 주소 응답
5. 로컬 DNS: .com DNS 서버에 질의
6. .com DNS: "google.com" DNS 서버 주소 응답
7. 로컬 DNS: google.com DNS 서버에 질의
8. google.com DNS: www.google.com의 IP 주소 응답
9. 로컬 DNS: 클라이언트에 IP 주소 전달
10. 클라이언트: 해당 IP로 HTTP 요청
```

**DNS 레코드 유형**:

| 레코드 유형 | 용도 | 예시 |
|:---|:---|:---|
| **A** | 도메인 → IPv4 주소 | www.example.com → 13.124.45.67 |
| **AAAA** | 도메인 → IPv6 주소 | www.example.com → 2001:db8::1 |
| **CNAME** | 도메인 → 다른 도메인 (별칭) | blog.example.com → example.com |
| **MX** | 메일 서버 지정 | example.com → mail.example.com |
| **NS** | 네임서버 지정 | example.com → ns1.awsdns.com |

💡 **AWS Route 53**: AWS의 관리형 DNS 서비스

---

### 🔹 방화벽 (Firewall)

#### 방화벽이란?

**방화벽**은 네트워크 트래픽을 **모니터링하고 제어**하는 보안 시스템입니다.

**방화벽의 역할**:
```
허용된 트래픽만 통과
    ↓
방화벽
    ↓
차단된 트래픽은 폐기
```

#### 전통적인 방화벽 (Stateless)

**제어 기준**:
1. **출발지 IP 주소**
2. **목적지 IP 주소**
3. **프로토콜** (TCP, UDP, ICMP)
4. **포트 번호**

**규칙 예시**:

| 순서 | 출발지 IP | 목적지 IP | 프로토콜 | 포트 | 동작 |
|:---:|:---|:---|:---:|:---:|:---:|
| 1 | 10.0.1.0/24 | Any | TCP | 80 | Allow |
| 2 | 10.0.1.0/24 | Any | TCP | 443 | Allow |
| 3 | 10.0.2.0/24 | 10.0.3.0/24 | TCP | 3306 | Allow |
| 4 | Any | Any | Any | Any | Deny |

**해석**:
```
규칙 1: 10.0.1.0/24 네트워크에서 외부로 HTTP (80) 허용
규칙 2: 10.0.1.0/24 네트워크에서 외부로 HTTPS (443) 허용
규칙 3: 10.0.2.0/24에서 10.0.3.0/24로 MySQL (3306) 허용
규칙 4: 나머지 모든 트래픽 차단 (Default Deny)
```

#### 차세대 방화벽 (Next-Generation Firewall)

**추가 기능**:
- **애플리케이션 인식**: HTTP 내의 특정 URL 패턴 차단
- **사용자 기반 제어**: IP가 아닌 사용자 ID로 제어
- **침입 탐지/방지** (IDS/IPS): 악성 트래픽 패턴 탐지
- **SSL/TLS 검사**: 암호화된 트래픽 내용 검사

💡 **AWS의 방화벽**:
- **Security Group**: Stateful 방화벽 (인스턴스 레벨)
- **Network ACL (NACL)**: Stateless 방화벽 (서브넷 레벨)

---

### 🔹 스케일링 및 로드 밸런싱

#### 스케일링 (Scaling)

**스케일링**은 **리소스를 확장하여 부하를 처리**하는 방법입니다.

**수직 스케일링 (Vertical Scaling, Scale Up)**:
```
기존 서버의 성능 향상
    ↓
CPU: 2코어 → 8코어
RAM: 4GB → 32GB
    ↓
한계: 단일 서버의 물리적 한계
```

**수평 스케일링 (Horizontal Scaling, Scale Out)**:
```
서버 개수 증가
    ↓
서버 1개 → 서버 3개
    ↓
로드 밸런서로 트래픽 분산
    ↓
무한 확장 가능 (이론적)
```

#### 로드 밸런싱 (Load Balancing)

**로드 밸런서**는 **여러 서버로 트래픽을 분산**합니다.

```mermaid
graph TB
    U1[사용자 1] --> LB[로드 밸런서]
    U2[사용자 2] --> LB
    U3[사용자 3] --> LB
    U4[사용자 4] --> LB

    LB --> S1[웹 서버 1]
    LB --> S2[웹 서버 2]
    LB --> S3[웹 서버 3]
    LB --> S4[웹 서버 4]
```

**로드 밸런싱 알고리즘**:

**1. 라운드 로빈 (Round Robin)**:
```
요청 1 → 서버 1
요청 2 → 서버 2
요청 3 → 서버 3
요청 4 → 서버 4
요청 5 → 서버 1 (반복)
```

**2. 최소 연결 (Least Connections)**:
```
서버 1: 10개 연결
서버 2: 5개 연결 ← 새 요청 여기로
서버 3: 15개 연결
서버 4: 8개 연결
```

**3. 가중치 기반 (Weighted)**:
```
서버 1: 가중치 50% (고성능)
서버 2: 가중치 25%
서버 3: 가중치 25%
```

**4. 응답 시간 기반 (Response Time)**:
```
가장 빠르게 응답하는 서버로 전송
```

💡 **AWS의 로드 밸런서**:
- **ALB (Application Load Balancer)**: HTTP/HTTPS (Layer 7)
- **NLB (Network Load Balancer)**: TCP/UDP (Layer 4)
- **CLB (Classic Load Balancer)**: 레거시

---

## ✅ 섹션 4 학습 체크리스트

- [ ] IP 주소와 사설 IP 범위를 이해한다
- [ ] CIDR 표기법을 읽고 IP 개수를 계산할 수 있다
- [ ] 서브넷의 개념과 분할 이유를 안다
- [ ] 라우팅 테이블의 작동 원리를 이해한다
- [ ] DNS의 이름 해석 과정을 설명할 수 있다
- [ ] 방화벽의 역할과 규칙을 이해한다
- [ ] 로드 밸런싱의 개념과 알고리즘을 안다

---

## 📋 섹션 4 핵심 요약

### 1. IP 주소
- **공인 IP**: 인터넷 통신용
- **사설 IP**: 내부 네트워크용 (10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16)

### 2. CIDR 및 서브넷
- **CIDR**: IP 주소 범위 표기법 (예: 10.0.1.0/24)
- **서브넷**: 네트워크 분할 (보안, 관리, 성능)

### 3. 라우팅
- **라우팅 테이블**: 패킷 전달 경로 정의
- **Default Route (0.0.0.0/0)**: 나머지 모든 트래픽의 경로

### 4. DNS
- **Name Resolution**: 도메인 → IP 주소 변환
- **계층 구조**: Root DNS → TLD DNS → Authoritative DNS

### 5. 방화벽
- **전통적 방화벽**: IP, 포트, 프로토콜 기반
- **차세대 방화벽**: 애플리케이션, 사용자 기반 + IDS/IPS

### 6. 로드 밸런싱
- **목적**: 트래픽 분산, 가용성 향상
- **알고리즘**: 라운드 로빈, 최소 연결, 가중치, 응답 시간
## 🏗️ 섹션 5: VPC (Virtual Private Cloud) 개념

### 학습 목표
- VPC의 개념과 특징 이해
- 서브넷 및 CIDR 블록 설계 방법 학습
- 퍼블릭 서브넷 vs 프라이빗 서브넷 구분
- 인터넷 게이트웨이와 NAT Gateway의 역할 파악
- 라우팅 테이블 설정 방법 이해

---

### 🔹 VPC (Virtual Private Cloud) 소개

#### VPC란?

**VPC (Virtual Private Cloud)**는 AWS 환경에서 생성할 수 있는 **가상 사설 네트워크**입니다.

**특징**:
- **논리적으로 격리된** 네트워크 공간
- **사설 IP 주소 범위** 사용 (RFC 1918)
- **고객이 완전히 제어** 가능
- **단일 리전에 종속**

```mermaid
graph TB
    subgraph "AWS 클라우드"
        subgraph "리전: ap-northeast-2 (서울)"
            V[VPC: 10.0.0.0/16]

            subgraph "가용 영역 A"
                SA1[퍼블릭 서브넷<br/>10.0.1.0/24]
                SA2[프라이빗 서브넷<br/>10.0.2.0/24]
            end

            subgraph "가용 영역 B"
                SB1[퍼블릭 서브넷<br/>10.0.3.0/24]
                SB2[프라이빗 서브넷<br/>10.0.4.0/24]
            end

            V --> SA1
            V --> SA2
            V --> SB1
            V --> SB2
        end
    end
```

#### VPC의 핵심 구성 요소

```
VPC
    ├─ CIDR 블록 (IP 주소 범위)
    ├─ 서브넷 (Subnets)
    ├─ 인터넷 게이트웨이 (Internet Gateway)
    ├─ NAT Gateway
    ├─ 라우팅 테이블 (Route Tables)
    ├─ 보안 그룹 (Security Groups)
    └─ 네트워크 ACL (Network ACLs)
```

---

### 🔹 VPC CIDR 블록

#### CIDR 블록 선택

VPC 생성 시 **사설 IP 주소 범위**를 지정해야 합니다.

**사용 가능한 사설 IP 범위**:
```
10.0.0.0 ~ 10.255.255.255 (10.0.0.0/8)
    → 가장 넓은 범위, 대규모 네트워크에 적합

172.16.0.0 ~ 172.31.255.255 (172.16.0.0/12)
    → 중간 규모

192.168.0.0 ~ 192.168.255.255 (192.168.0.0/16)
    → 가장 좁은 범위, 소규모 네트워크
```

**VPC CIDR 블록 예시**:
```
작은 규모: 10.0.0.0/24 (256개 IP)
중간 규모: 10.0.0.0/20 (4,096개 IP)
큰 규모: 10.0.0.0/16 (65,536개 IP) ✅ 권장
매우 큰 규모: 10.0.0.0/8 (16,777,216개 IP)
```

💡 **권장 크기**: **/16** (65,536개 IP)
- 충분히 넓어서 서브넷 분할 유연
- 너무 크지 않아 관리 용이

#### CIDR 블록 설계 시 고려사항

**1. 온프레미스와 연결 계획이 있는가?**
```
온프레미스 네트워크: 192.168.0.0/16 사용 중

❌ 잘못된 VPC CIDR: 192.168.0.0/16
    → IP 충돌 발생!

✅ 올바른 VPC CIDR: 10.0.0.0/16
    → 충돌 없음
```

**2. 여러 VPC를 연결할 계획이 있는가?**
```
VPC 1: 10.0.0.0/16
VPC 2: 10.1.0.0/16 ✅
VPC 3: 10.2.0.0/16 ✅

VPC Peering으로 연결 시 IP 중복 없음
```

**3. 향후 확장 가능성**
```
초기: 작은 CIDR 선택 (10.0.0.0/24)
    ↓
나중에: 서브넷 추가 필요
    ↓
문제: IP 부족!

해결책: 처음부터 넉넉하게 설계 (/16 권장)
```

---

### 🔹 서브넷 (Subnets)

#### 서브넷이란?

**서브넷**은 VPC의 **IP 주소 범위를 더 작은 단위로 분할**한 것입니다.

**특징**:
- **단일 가용 영역에 속함** (다중 AZ 불가)
- VPC CIDR 블록의 **하위 범위** 사용
- 서브넷 간 **IP 중복 불가**

#### 서브넷 설계 예시

**VPC CIDR: 10.0.0.0/16**

| 서브넷 | CIDR | IP 개수 | 가용 영역 | 용도 |
|:---|:---|:---:|:---:|:---|
| Public Subnet A | 10.0.1.0/24 | 256 | ap-northeast-2a | 웹 서버, 로드 밸런서 |
| Private Subnet A | 10.0.2.0/24 | 256 | ap-northeast-2a | 애플리케이션 서버 |
| Database Subnet A | 10.0.3.0/24 | 256 | ap-northeast-2a | 데이터베이스 |
| Public Subnet B | 10.0.11.0/24 | 256 | ap-northeast-2b | 웹 서버, 로드 밸런서 |
| Private Subnet B | 10.0.12.0/24 | 256 | ap-northeast-2b | 애플리케이션 서버 |
| Database Subnet B | 10.0.13.0/24 | 256 | ap-northeast-2b | 데이터베이스 |

**IP 중복 검증**:
```
10.0.1.0/24 = 10.0.1.0 ~ 10.0.1.255
10.0.2.0/24 = 10.0.2.0 ~ 10.0.2.255
10.0.3.0/24 = 10.0.3.0 ~ 10.0.3.255
...

✅ 모든 서브넷이 서로 다른 IP 범위 사용
```

---

### 🔹 퍼블릭 서브넷 vs 프라이빗 서브넷

#### 개념 구분

| 항목 | 퍼블릭 서브넷 | 프라이빗 서브넷 |
|:---|:---|:---|
| **인터넷 통신** | ✅ 가능 | ❌ 직접 불가 (NAT 필요) |
| **라우팅 테이블** | 인터넷 게이트웨이(IGW) 포함 | IGW 없음 |
| **IP 할당** | 공인 IP + 사설 IP | 사설 IP만 |
| **주요 용도** | 웹 서버, 로드 밸런서, Bastion Host | 애플리케이션 서버, 데이터베이스 |
| **보안 수준** | 낮음 (인터넷 노출) | 높음 (내부 네트워크) |

#### 퍼블릭 서브넷

**정의**: 인터넷 게이트웨이로 가는 라우팅이 있는 서브넷

```mermaid
graph LR
    Internet[인터넷] --> IGW[인터넷 게이트웨이]
    IGW --> PS[퍼블릭 서브넷<br/>10.0.1.0/24]
    PS --> WS[웹 서버<br/>공인 IP: 13.124.45.67<br/>사설 IP: 10.0.1.10]
```

**라우팅 테이블 (Public Route Table)**:
```
목적지: 10.0.0.0/16 → Target: local
    (VPC 내부 통신)

목적지: 0.0.0.0/0 → Target: igw-1234abcd
    (인터넷 통신)
```

**용도**:
- 웹 서버 (외부 사용자 접근)
- 로드 밸런서 (ALB/NLB)
- Bastion Host (SSH 점프 서버)
- NAT Gateway (프라이빗 서브넷의 아웃바운드 인터넷 액세스)

#### 프라이빗 서브넷

**정의**: 인터넷 게이트웨이로 가는 라우팅이 **없는** 서브넷

```mermaid
graph LR
    PS[퍼블릭 서브넷<br/>NAT Gateway] --> Internet[인터넷]
    PRS[프라이빗 서브넷<br/>10.0.2.0/24]
    PRS --> PS
    PRS --> AS[애플리케이션 서버<br/>사설 IP: 10.0.2.10]
    PRS --> DB[데이터베이스<br/>사설 IP: 10.0.2.20]
```

**라우팅 테이블 (Private Route Table)**:
```
목적지: 10.0.0.0/16 → Target: local
    (VPC 내부 통신)

목적지: 0.0.0.0/0 → Target: nat-5678abcd
    (인터넷 통신, NAT Gateway 경유)
```

**용도**:
- 애플리케이션 서버
- 데이터베이스 (RDS, Aurora)
- 캐시 서버 (Redis, Memcached)
- 내부 마이크로서비스

---

### 🔹 인터넷 게이트웨이 (Internet Gateway, IGW)

#### 인터넷 게이트웨이란?

**인터넷 게이트웨이**는 VPC와 인터넷 간의 **통신을 가능하게 하는 구성 요소**입니다.

**특징**:
- VPC당 **1개만** 연결 가능
- **수평 확장** (자동 스케일링)
- **이중화** (고가용성)
- **무료** (데이터 전송 비용만 발생)

#### 인터넷 게이트웨이의 역할

**1. NAT (Network Address Translation)**:
```
아웃바운드 (VPC → 인터넷):
    사설 IP → 공인 IP로 변환

예:
    EC2 (10.0.1.10) → IGW → 인터넷
    출발지 IP: 10.0.1.10 → 13.124.45.67로 변환
```

**2. 인바운드 (인터넷 → VPC)**:
```
인바운드:
    공인 IP → 사설 IP로 변환

예:
    인터넷 → IGW → EC2 (10.0.1.10)
    목적지 IP: 13.124.45.67 → 10.0.1.10로 변환
```

```mermaid
sequenceDiagram
    participant U as 사용자 (인터넷)
    participant IGW as Internet Gateway
    participant EC2 as EC2 (10.0.1.10)

    Note over EC2: 공인 IP: 13.124.45.67<br/>사설 IP: 10.0.1.10

    U->>IGW: HTTP 요청<br/>목적지: 13.124.45.67
    IGW->>EC2: HTTP 요청<br/>목적지: 10.0.1.10 (변환)
    EC2->>IGW: HTTP 응답<br/>출발지: 10.0.1.10
    IGW->>U: HTTP 응답<br/>출발지: 13.124.45.67 (변환)
```

#### 인터넷 게이트웨이 생성 및 연결

**Step 1: IGW 생성**:
```
VPC 콘솔 → Internet Gateways → Create internet gateway
    Name: my-vpc-igw
    → Create internet gateway
```

**Step 2: VPC에 연결**:
```
Actions → Attach to VPC
    VPC: my-vpc (10.0.0.0/16)
    → Attach internet gateway
```

**Step 3: 라우팅 테이블 업데이트**:
```
Route Tables → Public Route Table 선택
    → Routes → Edit routes
    → Add route:
        Destination: 0.0.0.0/0
        Target: igw-1234abcd
    → Save changes
```

---

### 🔹 NAT Gateway

#### NAT Gateway란?

**NAT Gateway**는 **프라이빗 서브넷의 인스턴스가 인터넷에 연결**할 수 있게 해주는 관리형 서비스입니다.

**특징**:
- **아웃바운드 전용** (인터넷 → 프라이빗 서브넷 불가)
- **단일 가용 영역**에 배치
- **Elastic IP** 필요
- **시간당 요금 + 데이터 처리 요금** 발생

#### NAT Gateway vs NAT Instance

| 항목 | NAT Gateway (권장) | NAT Instance |
|:---|:---|:---|
| **가용성** | AWS 관리 (고가용성) | 직접 관리 (단일 장애점) |
| **대역폭** | 최대 100 Gbps (자동 스케일) | 인스턴스 타입 의존 |
| **유지보수** | AWS가 관리 | 직접 패치 및 관리 |
| **비용** | 시간당 $0.045 + 데이터 $0.045/GB | 인스턴스 비용 |
| **보안 그룹** | 필요 없음 | 필요함 |

💡 **권장**: **NAT Gateway** 사용 (관리 부담 없음)

#### NAT Gateway 작동 원리

```mermaid
sequenceDiagram
    participant PRS as 프라이빗 서브넷<br/>EC2 (10.0.2.10)
    participant NAT as NAT Gateway<br/>(10.0.1.100)<br/>EIP: 13.124.45.100
    participant IGW as Internet Gateway
    participant I as 인터넷

    PRS->>NAT: HTTP 요청<br/>목적지: google.com<br/>출발지: 10.0.2.10
    NAT->>IGW: HTTP 요청<br/>목적지: google.com<br/>출발지: 13.124.45.100 (변환)
    IGW->>I: HTTP 요청
    I->>IGW: HTTP 응답
    IGW->>NAT: HTTP 응답<br/>목적지: 13.124.45.100
    NAT->>PRS: HTTP 응답<br/>목적지: 10.0.2.10 (변환)
```

**핵심**:
- 프라이빗 서브넷 → 인터넷: ✅ 가능 (NAT Gateway 경유)
- 인터넷 → 프라이빗 서브넷: ❌ 불가능 (보안 유지)

#### NAT Gateway 생성

**Step 1: NAT Gateway 생성**:
```
VPC 콘솔 → NAT Gateways → Create NAT gateway
    Name: my-nat-gateway
    Subnet: Public Subnet A (10.0.1.0/24) ✅ 퍼블릭 서브넷에 생성!
    Elastic IP: Allocate Elastic IP
    → Create NAT gateway
```

**Step 2: 프라이빗 라우팅 테이블 업데이트**:
```
Route Tables → Private Route Table 선택
    → Routes → Edit routes
    → Add route:
        Destination: 0.0.0.0/0
        Target: nat-5678abcd
    → Save changes
```

**고가용성을 위한 NAT Gateway 배치**:
```
권장 구성:
    가용 영역 A: NAT Gateway A (퍼블릭 서브넷 A)
    가용 영역 B: NAT Gateway B (퍼블릭 서브넷 B)

    프라이빗 서브넷 A → NAT Gateway A
    프라이빗 서브넷 B → NAT Gateway B

이유:
    - 가용 영역 A 장애 시 → B는 정상 작동
    - 교차 AZ 데이터 전송 비용 절감
```

---

### 🔹 라우팅 테이블 (Route Tables)

#### 라우팅 테이블이란?

**라우팅 테이블**은 **네트워크 트래픽의 경로를 결정하는 규칙 집합**입니다.

**구성 요소**:
- **Destination (목적지)**: CIDR 블록
- **Target (대상)**: 트래픽을 보낼 곳

#### 라우팅 테이블 예시

**퍼블릭 라우팅 테이블**:

| Destination | Target | 설명 |
|:---|:---|:---|
| 10.0.0.0/16 | local | VPC 내부 통신 (자동 추가) |
| 0.0.0.0/0 | igw-1234abcd | 인터넷 통신 (인터넷 게이트웨이) |

**프라이빗 라우팅 테이블**:

| Destination | Target | 설명 |
|:---|:---|:---|
| 10.0.0.0/16 | local | VPC 내부 통신 (자동 추가) |
| 0.0.0.0/0 | nat-5678abcd | 인터넷 통신 (NAT Gateway) |

#### 라우팅 우선순위

여러 라우팅 규칙이 일치할 때 **가장 구체적인 규칙** (긴 프리픽스)이 우선합니다.

**예시**:
```
목적지 IP: 10.0.1.50

라우팅 테이블:
1. 10.0.0.0/16 → local
2. 10.0.1.0/24 → eni-abc123
3. 0.0.0.0/0 → igw-1234abcd

매칭:
    10.0.0.0/16 (16비트) ✅ 매칭
    10.0.1.0/24 (24비트) ✅ 매칭 ← 가장 구체적!
    0.0.0.0/0 (0비트) ✅ 매칭

선택: 10.0.1.0/24 → eni-abc123 (가장 긴 프리픽스)
```

---

## ✅ 섹션 5 학습 체크리스트

- [ ] VPC의 개념과 특징을 이해한다
- [ ] VPC CIDR 블록을 설계할 수 있다
- [ ] 서브넷을 분할하고 설계할 수 있다
- [ ] 퍼블릭 서브넷과 프라이빗 서브넷을 구분한다
- [ ] 인터넷 게이트웨이의 역할을 이해한다
- [ ] NAT Gateway의 작동 원리를 이해한다
- [ ] 라우팅 테이블을 설정할 수 있다

---

## 📋 섹션 5 핵심 요약

### 1. VPC 기본 개념
- **가상 사설 네트워크**: AWS 클라우드 내 논리적으로 격리된 네트워크
- **CIDR 블록**: 사설 IP 범위 지정 (권장: /16)
- **단일 리전**: VPC는 하나의 리전에만 속함

### 2. 서브넷
- **VPC 분할**: IP 주소 범위를 더 작은 단위로 분할
- **단일 가용 영역**: 각 서브넷은 하나의 AZ에만 배치
- **IP 중복 불가**: 서브넷 간 IP 범위 중복 금지

### 3. 퍼블릭 vs 프라이빗 서브넷
- **퍼블릭 서브넷**: 인터넷 게이트웨이 라우팅 포함, 공인 IP 사용
- **프라이빗 서브넷**: IGW 라우팅 없음, 사설 IP만 사용, NAT Gateway로 아웃바운드

### 4. 인터넷 게이트웨이 (IGW)
- **VPC와 인터넷 연결**: 양방향 통신
- **NAT 기능**: 사설 IP ↔ 공인 IP 변환
- **고가용성**: AWS 관리, 자동 스케일링

### 5. NAT Gateway
- **프라이빗 서브넷의 아웃바운드 인터넷 액세스**
- **단방향**: 프라이빗 → 인터넷만 가능
- **고가용성**: 가용 영역별로 NAT Gateway 배치 권장

### 6. 라우팅 테이블
- **트래픽 경로 결정**: Destination + Target
- **우선순위**: 가장 구체적인 규칙 (긴 프리픽스) 우선
- **로컬 라우팅**: VPC 내부 통신은 자동 라우팅
## 🧪 섹션 6: VPC 실습 및 종합 정리

### 학습 목표
- VPC 생성 실습 진행
- 서브넷, 라우팅 테이블, 게이트웨이 설정 실습
- VPC 리소스 삭제 방법 학습
- 2일차 강의 전체 내용 종합 정리

---

### 🔹 VPC 생성 실습

#### 실습 시나리오

**목표**: 고가용성을 갖춘 웹 애플리케이션 인프라 구축

**요구사항**:
- 2개의 가용 영역 사용
- 각 AZ에 퍼블릭 서브넷 1개, 프라이빗 서브넷 1개
- 인터넷 게이트웨이 설정
- NAT Gateway 설정 (1개)
- 적절한 라우팅 테이블 구성

**아키텍처**:
```mermaid
graph TB
    Internet[인터넷]
    IGW[Internet Gateway]

    subgraph "VPC: 10.0.0.0/16"
        subgraph "가용 영역 A"
            PS1[퍼블릭 서브넷 A<br/>10.0.1.0/24]
            PRS1[프라이빗 서브넷 A<br/>10.0.2.0/24]
        end

        subgraph "가용 영역 B"
            PS2[퍼블릭 서브넷 B<br/>10.0.3.0/24]
            PRS2[프라이빗 서브넷 B<br/>10.0.4.0/24]
        end

        NAT[NAT Gateway]
        RTPublic[Public Route Table]
        RTPrivate[Private Route Table]
    end

    Internet --> IGW
    IGW --> PS1
    IGW --> PS2
    PS1 --> NAT
    NAT --> PRS1
    NAT --> PRS2

    PS1 -.-> RTPublic
    PS2 -.-> RTPublic
    PRS1 -.-> RTPrivate
    PRS2 -.-> RTPrivate
```

---

### 🔹 실습 1: VPC 및 서브넷 생성 (수동)

#### Step 1: VPC 생성

**AWS 콘솔 접근**:
```
AWS 콘솔 → 검색창에 "VPC" 입력 → VPC 서비스 선택
```

**VPC 생성**:
```
Your VPCs → Create VPC

설정:
    Resources to create: VPC only (수동 설정)
    Name tag: my-first-vpc
    IPv4 CIDR block: 10.0.0.0/16
    IPv6 CIDR block: No IPv6 CIDR block
    Tenancy: Default

→ Create VPC
```

#### Step 2: 서브넷 생성

**퍼블릭 서브넷 A**:
```
Subnets → Create subnet

설정:
    VPC ID: my-first-vpc (10.0.0.0/16)
    Subnet name: public-subnet-a
    Availability Zone: ap-northeast-2a
    IPv4 CIDR block: 10.0.1.0/24

→ Create subnet
```

**프라이빗 서브넷 A**:
```
설정:
    VPC ID: my-first-vpc
    Subnet name: private-subnet-a
    Availability Zone: ap-northeast-2a
    IPv4 CIDR block: 10.0.2.0/24

→ Create subnet
```

**퍼블릭 서브넷 B**:
```
설정:
    VPC ID: my-first-vpc
    Subnet name: public-subnet-b
    Availability Zone: ap-northeast-2b
    IPv4 CIDR block: 10.0.3.0/24

→ Create subnet
```

**프라이빗 서브넷 B**:
```
설정:
    VPC ID: my-first-vpc
    Subnet name: private-subnet-b
    Availability Zone: ap-northeast-2b
    IPv4 CIDR block: 10.0.4.0/24

→ Create subnet
```

#### Step 3: 인터넷 게이트웨이 생성 및 연결

**IGW 생성**:
```
Internet Gateways → Create internet gateway

설정:
    Name tag: my-igw

→ Create internet gateway
```

**VPC에 연결**:
```
생성된 IGW 선택 → Actions → Attach to VPC

설정:
    Available VPCs: my-first-vpc

→ Attach internet gateway
```

**확인**:
```
State: Attached ✅
VPC ID: vpc-xxxxx (my-first-vpc)
```

#### Step 4: NAT Gateway 생성

**Elastic IP 할당**:
```
Elastic IP addresses → Allocate Elastic IP address

설정:
    (기본 설정 그대로)

→ Allocate
```

**NAT Gateway 생성**:
```
NAT Gateways → Create NAT gateway

설정:
    Name: my-nat-gateway
    Subnet: public-subnet-a (10.0.1.0/24) ✅ 퍼블릭 서브넷!
    Elastic IP allocation ID: eipalloc-xxxxx (방금 생성한 EIP)

→ Create NAT gateway
```

**대기**:
```
Status: Pending → Available (약 1-2분 소요)
```

#### Step 5: 라우팅 테이블 생성 및 설정

**퍼블릭 라우팅 테이블**:
```
Route Tables → Create route table

설정:
    Name: public-route-table
    VPC: my-first-vpc

→ Create route table
```

**인터넷 게이트웨이 라우팅 추가**:
```
public-route-table 선택 → Routes → Edit routes

→ Add route:
    Destination: 0.0.0.0/0
    Target: Internet Gateway → my-igw

→ Save changes
```

**서브넷 연결**:
```
public-route-table 선택 → Subnet associations → Edit subnet associations

☑ public-subnet-a (10.0.1.0/24)
☑ public-subnet-b (10.0.3.0/24)

→ Save associations
```

**프라이빗 라우팅 테이블**:
```
Route Tables → Create route table

설정:
    Name: private-route-table
    VPC: my-first-vpc

→ Create route table
```

**NAT Gateway 라우팅 추가**:
```
private-route-table 선택 → Routes → Edit routes

→ Add route:
    Destination: 0.0.0.0/0
    Target: NAT Gateway → my-nat-gateway

→ Save changes
```

**서브넷 연결**:
```
private-route-table 선택 → Subnet associations → Edit subnet associations

☑ private-subnet-a (10.0.2.0/24)
☑ private-subnet-b (10.0.4.0/24)

→ Save associations
```

---

### 🔹 실습 2: VPC 마법사 사용 (빠른 생성)

#### VPC 마법사란?

**VPC and more** 옵션은 VPC, 서브넷, 게이트웨이, 라우팅 테이블을 **한 번에 자동 생성**합니다.

#### 마법사 실행

**VPC 생성 시작**:
```
VPCs → Create VPC

설정:
    Resources to create: VPC and more ✅
```

**설정 값 입력**:
```
VPC settings:
    Name tag auto-generation: my-auto-vpc
    IPv4 CIDR block: 10.1.0.0/16

Availability Zones (AZs):
    Number of AZs: 2

Number of public subnets: 2
Number of private subnets: 2

NAT gateways:
    ⚪ None
    ⚪ In 1 AZ ✅ (비용 절감)
    ⚪ 1 per AZ (고가용성)

VPC endpoints:
    S3 Gateway: None

DNS options:
    ☑ Enable DNS hostnames
    ☑ Enable DNS resolution

→ Create VPC
```

**결과**:
```
자동 생성됨:
    ✅ VPC: my-auto-vpc (10.1.0.0/16)
    ✅ 퍼블릭 서브넷 2개
    ✅ 프라이빗 서브넷 2개
    ✅ 인터넷 게이트웨이
    ✅ NAT Gateway 1개
    ✅ 퍼블릭 라우팅 테이블
    ✅ 프라이빗 라우팅 테이블 2개 (각 AZ별)
    ✅ 라우팅 규칙 모두 설정됨
```

💡 **권장**: 프로덕션 환경에서는 마법사 사용 (빠르고 오류 없음)

---

### 🔹 리소스 삭제 실습

#### 삭제 순서

VPC 리소스는 **의존성**이 있으므로 **역순**으로 삭제해야 합니다.

```
생성 순서:
VPC → 서브넷 → IGW → NAT → 라우팅 테이블

삭제 순서:
NAT Gateway → Elastic IP → 인터넷 게이트웨이 → VPC
```

#### Step 1: NAT Gateway 삭제

**라우팅 테이블에서 NAT 경로 제거**:
```
Route Tables → private-route-table 선택
    → Routes → Edit routes
    → 0.0.0.0/0 (nat-xxxxx) 항목 삭제
    → Save changes
```

**NAT Gateway 삭제**:
```
NAT Gateways → my-nat-gateway 선택
    → Actions → Delete NAT gateway
    → 확인 입력: delete
    → Delete

상태: Available → Deleting → Deleted (약 5분 소요)
```

⏰ **대기 필요**: NAT Gateway가 완전히 삭제될 때까지 기다려야 합니다.

#### Step 2: Elastic IP 해제 (Release)

**NAT Gateway 삭제 확인 후**:
```
Elastic IP addresses → NAT Gateway에 사용했던 EIP 선택
    → Actions → Release Elastic IP address
    → Release
```

⚠️ **주의**: NAT Gateway가 삭제되기 전에는 EIP 해제 불가!

**문제 발생 시**:
```
에러: "The Elastic IP address is currently associated with..."

해결책:
    1. NAT Gateway 상태 확인 (Deleted 상태여야 함)
    2. 몇 분 대기 후 재시도
    3. 페이지 새로고침 (F5)
```

#### Step 3: 인터넷 게이트웨이 삭제

**라우팅 테이블에서 IGW 경로 제거** (선택사항):
```
Route Tables → public-route-table 선택
    → Routes → Edit routes
    → 0.0.0.0/0 (igw-xxxxx) 항목 삭제
    → Save changes
```

**VPC에서 IGW 분리 (Detach)**:
```
Internet Gateways → my-igw 선택
    → Actions → Detach from VPC
    → Detach internet gateway
```

**IGW 삭제**:
```
my-igw 선택 (State: Detached)
    → Actions → Delete internet gateway
    → 확인 입력: delete
    → Delete internet gateway
```

#### Step 4: VPC 삭제 (전체 삭제)

**VPC 삭제 (서브넷, 라우팅 테이블 등 모두 삭제)**:
```
VPCs → my-first-vpc 선택
    → Actions → Delete VPC

연결된 리소스 확인:
    - Subnets: 4개
    - Route tables: 3개
    - Network ACLs: 1개
    - Security groups: 1개

→ Delete VPC
```

**결과**:
```
VPC 및 연결된 모든 리소스가 삭제됨:
    ✅ 서브넷 4개
    ✅ 라우팅 테이블 3개
    ✅ 기본 Network ACL
    ✅ 기본 Security Group
```

💡 **팁**: VPC를 삭제하면 연결된 서브넷, 라우팅 테이블 등이 **자동으로** 삭제됩니다.

⚠️ **주의사항**: NAT Gateway와 Elastic IP는 **수동으로** 먼저 삭제해야 합니다!

---

### 🔹 비용 관리 팁

#### 비용 발생 리소스

**무료 리소스**:
```
✅ VPC 자체 (무료)
✅ 서브넷 (무료)
✅ 인터넷 게이트웨이 (무료, 데이터 전송 비용만 발생)
✅ 라우팅 테이블 (무료)
✅ Security Group (무료)
✅ Network ACL (무료)
```

**유료 리소스** ⚠️:
```
❌ NAT Gateway:
    - 시간당 요금: $0.045/시간 (약 월 $32)
    - 데이터 처리: $0.045/GB

❌ Elastic IP (미사용 시):
    - 연결되지 않은 EIP: $0.005/시간 (약 월 $3.6)
    - 연결된 EIP: 무료

❌ 데이터 전송:
    - 인터넷으로 나가는 데이터: $0.09~/GB
    - 들어오는 데이터: 무료
```

#### 실습 후 비용 절감 방법

**실습 종료 시 즉시 삭제**:
```
1. NAT Gateway 삭제 ← 가장 비용 큼!
2. Elastic IP 해제
3. (선택) 인터넷 게이트웨이 삭제
4. (선택) VPC 유지 (VPC 자체는 무료)
```

**실습 중 비용 절감**:
```
- NAT Gateway: 1개만 사용 (고가용성 포기)
- 실습 후 즉시 삭제
- Elastic IP: 사용하지 않으면 즉시 해제
```

**실제 운영 환경**:
```
- 고가용성 필요: 각 AZ에 NAT Gateway 배치
- 비용 vs 가용성 트레이드오프 고려
```

---

### 🔹 실습 문제 해결

#### 문제 1: NAT Gateway 삭제 안 됨

**증상**:
```
NAT Gateway 상태가 계속 "Deleting"
```

**원인**:
- 라우팅 테이블에서 NAT Gateway를 참조하는 규칙이 남아있음

**해결**:
```
1. Route Tables → 모든 라우팅 테이블 확인
2. NAT Gateway를 Target으로 하는 규칙 모두 삭제
3. NAT Gateway 다시 삭제 시도
```

#### 문제 2: Elastic IP 해제 실패

**증상**:
```
"The Elastic IP address is currently associated..."
```

**원인**:
- NAT Gateway가 아직 삭제되지 않음

**해결**:
```
1. NAT Gateways → 상태 확인 (Deleted 상태여야 함)
2. 5분 대기
3. 페이지 새로고침 (F5)
4. Elastic IP 다시 해제 시도
```

#### 문제 3: VPC 삭제 실패

**증상**:
```
"The vpc has dependencies and cannot be deleted"
```

**원인**:
- EC2 인스턴스, RDS, ELB 등 다른 리소스가 VPC에 연결됨

**해결**:
```
1. EC2 콘솔 → 인스턴스 모두 종료
2. RDS 콘솔 → 데이터베이스 삭제
3. ELB 콘솔 → 로드 밸런서 삭제
4. 모든 리소스 삭제 후 VPC 다시 삭제
```

---

## 🎓 2일차 강의 종합 정리

### 학습한 주요 주제

#### 1. IAM (Identity and Access Management)

**핵심 개념**:
- **루트 사용자**: 무제한 권한, MFA 필수, 일상 작업 사용 금지
- **IAM 사용자**: 개인 계정, 영구 자격 증명
- **IAM 그룹**: 사용자 모음, 권한 일괄 관리
- **IAM 정책**: JSON 형식의 권한 정의
- **IAM 역할**: 임시 자격 증명, EC2/Lambda/교차 계정 액세스

**보안 모범 사례**:
```
✅ 루트 사용자 MFA 활성화
✅ IAM 사용자 개별 생성
✅ 최소 권한 부여
✅ 그룹 활용
✅ 정기적인 액세스 키 교체
✅ 강력한 비밀번호 정책
```

#### 2. 네트워크 기초

**핵심 개념**:
- **IP 주소**: 공인 IP vs 사설 IP
- **CIDR**: IP 범위 표기법 (예: 10.0.0.0/16)
- **서브넷**: 네트워크 분할
- **라우팅**: 패킷 경로 결정
- **DNS**: 도메인 → IP 변환
- **방화벽**: 트래픽 제어
- **로드 밸런싱**: 트래픽 분산

#### 3. VPC (Virtual Private Cloud)

**핵심 구성 요소**:
```
VPC (10.0.0.0/16)
    ├─ 퍼블릭 서브넷 (10.0.1.0/24, 10.0.3.0/24)
    ├─ 프라이빗 서브넷 (10.0.2.0/24, 10.0.4.0/24)
    ├─ 인터넷 게이트웨이 (양방향 인터넷 통신)
    ├─ NAT Gateway (프라이빗 → 인터넷 단방향)
    ├─ 퍼블릭 라우팅 테이블 (0.0.0.0/0 → IGW)
    └─ 프라이빗 라우팅 테이블 (0.0.0.0/0 → NAT)
```

**설계 원칙**:
- 충분한 IP 범위 (/16 권장)
- 멀티 AZ 배포 (고가용성)
- 퍼블릭/프라이빗 서브넷 분리 (보안)
- NAT Gateway 다중화 (가용성 vs 비용)

---

### 다음 학습 주제 (3일차 예상)

**컴퓨팅 서비스**:
- **EC2 (Elastic Compute Cloud)**: 가상 서버
- 인스턴스 타입 선택
- AMI (Amazon Machine Image)
- 보안 그룹 설정
- EC2를 VPC에 배포

**실습**:
- VPC에 EC2 인스턴스 생성
- 퍼블릭 서브넷에 웹 서버 배포
- 프라이빗 서브넷에 애플리케이션 서버 배포
- Bastion Host를 통한 SSH 접근

---

## ✅ 최종 학습 체크리스트

### IAM
- [ ] 루트 사용자와 IAM 사용자의 차이를 이해한다
- [ ] MFA를 설정할 수 있다
- [ ] IAM 사용자, 그룹, 정책을 생성할 수 있다
- [ ] IAM 역할의 개념을 이해한다
- [ ] 액세스 키를 안전하게 관리하는 방법을 안다

### 네트워크 기초
- [ ] IP 주소와 CIDR 표기법을 이해한다
- [ ] 서브넷 분할 개념을 안다
- [ ] 라우팅 테이블의 작동 원리를 이해한다
- [ ] DNS의 이름 해석 과정을 설명할 수 있다
- [ ] 로드 밸런싱의 개념을 안다

### VPC
- [ ] VPC를 생성할 수 있다
- [ ] 서브넷을 설계하고 생성할 수 있다
- [ ] 퍼블릭/프라이빗 서브넷을 구분한다
- [ ] 인터넷 게이트웨이를 설정할 수 있다
- [ ] NAT Gateway를 생성하고 설정할 수 있다
- [ ] 라우팅 테이블을 구성할 수 있다
- [ ] VPC 리소스를 올바른 순서로 삭제할 수 있다

---

## 📋 최종 핵심 요약

### 1. IAM - 계정 및 권한 관리
- **계정 보안**: 루트 사용자 MFA, IAM 사용자 활용
- **권한 관리**: 최소 권한 원칙, 그룹 활용
- **임시 자격 증명**: IAM 역할 사용 (EC2, Lambda)

### 2. 네트워크 - TCP/IP 기초
- **IP 주소**: 공인 IP (인터넷), 사설 IP (내부)
- **CIDR**: 10.0.0.0/16 형식으로 IP 범위 표기
- **라우팅**: 패킷 전달 경로 결정
- **DNS**: 도메인 이름을 IP 주소로 변환

### 3. VPC - AWS 가상 네트워크
- **VPC**: 논리적으로 격리된 가상 네트워크 (사설 IP 사용)
- **서브넷**: 퍼블릭 (IGW), 프라이빗 (NAT Gateway)
- **게이트웨이**: IGW (양방향), NAT (단방향)
- **라우팅**: 트래픽 경로 제어

### 4. 설계 원칙
- **고가용성**: 멀티 AZ 배포
- **보안**: 퍼블릭/프라이빗 분리, 최소 권한
- **비용 최적화**: 불필요한 리소스 즉시 삭제

---

## 🎉 수고하셨습니다!

오늘 학습한 IAM과 VPC는 AWS의 **가장 기본이 되는 서비스**입니다.

**다음 단계**:
1. 오늘 배운 내용 복습
2. 실습 재진행 (반복 학습)
3. AWS 프리 티어 계정으로 자유롭게 실습
4. 3일차 강의 준비 (EC2 컴퓨팅 서비스)

**학습 자료**:
- AWS 공식 문서: https://docs.aws.amazon.com/
- AWS Well-Architected Framework
- AWS Skill Builder (무료 온라인 교육)

**질문이 있으시면 언제든지 문의하세요!** 🙋‍♂️

---

## 📚 참고 자료

**AWS 공식 문서**:
- IAM User Guide: https://docs.aws.amazon.com/IAM/
- VPC User Guide: https://docs.aws.amazon.com/vpc/
- AWS Well-Architected Framework: https://aws.amazon.com/architecture/well-architected/

**추천 학습 경로**:
1. AWS Certified Cloud Practitioner (입문)
2. AWS Certified Solutions Architect - Associate (중급)
3. AWS Certified Solutions Architect - Professional (고급)

**실습 환경**:
- AWS 프리 티어: 12개월 무료
- AWS Educate: 학생용 크레딧 제공
- AWS Skill Builder: 무료 랩 환경

---

**강의 종료! 감사합니다!** ✨🎓
